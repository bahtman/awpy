<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>awpy.analytics.stats &mdash; awpy 1.1.1 documentation</title>
      <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js"></script>
        <script src="../../../_static/jquery.js"></script>
        <script src="../../../_static/underscore.js"></script>
        <script src="../../../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../../../_static/doctools.js"></script>
    <script src="../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../../../index.html" class="icon icon-home"> awpy
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Getting Started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../examples.html">Example Notebooks</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../projects.html">Projects</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../faq.html">Frequently Asked Questions (FAQs)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../license.html">License and Acknowledgments</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Documentation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../analytics.html">Analytics</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../data.html">Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../parser.html">Parser</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../visualization.html">Visualization</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">awpy</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../index.html" class="icon icon-home"></a> &raquo;</li>
          <li><a href="../../index.html">Module code</a> &raquo;</li>
      <li>awpy.analytics.stats</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <h1>Source code for awpy.analytics.stats</h1><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="c1"># accuracy</span>
<span class="c1"># kast</span>
<span class="c1"># adr</span>
<span class="c1"># kill stats</span>
<span class="c1"># flash stats</span>
<span class="c1"># econ stats</span>
<div class="viewcode-block" id="player_stats"><a class="viewcode-back" href="../../../analytics.html#awpy.analytics.stats.player_stats">[docs]</a><span class="k">def</span> <span class="nf">player_stats</span><span class="p">(</span><span class="n">game_rounds</span><span class="p">,</span> <span class="n">return_type</span><span class="o">=</span><span class="s2">&quot;json&quot;</span><span class="p">):</span>
    <span class="n">player_statistics</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">game_rounds</span><span class="p">:</span>
        <span class="c1"># Add players</span>
        <span class="n">ct_side</span> <span class="o">=</span> <span class="n">r</span><span class="p">[</span><span class="s2">&quot;ctSide&quot;</span><span class="p">]</span>
        <span class="n">t_side</span> <span class="o">=</span> <span class="n">r</span><span class="p">[</span><span class="s2">&quot;tSide&quot;</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">ct_side</span><span class="p">[</span><span class="s2">&quot;players&quot;</span><span class="p">]:</span>
            <span class="k">if</span> <span class="n">p</span><span class="p">[</span><span class="s2">&quot;steamID&quot;</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">p</span><span class="p">[</span><span class="s2">&quot;steamID&quot;</span><span class="p">]</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">player_statistics</span><span class="p">:</span>
                    <span class="n">player_statistics</span><span class="p">[</span><span class="n">p</span><span class="p">[</span><span class="s2">&quot;steamID&quot;</span><span class="p">]]</span> <span class="o">=</span> <span class="p">{</span>
                        <span class="s2">&quot;steamID&quot;</span><span class="p">:</span> <span class="n">p</span><span class="p">[</span><span class="s2">&quot;steamID&quot;</span><span class="p">],</span>
                        <span class="s2">&quot;playerName&quot;</span><span class="p">:</span> <span class="n">p</span><span class="p">[</span><span class="s2">&quot;playerName&quot;</span><span class="p">],</span>
                        <span class="s2">&quot;teamName&quot;</span><span class="p">:</span> <span class="n">ct_side</span><span class="p">[</span><span class="s2">&quot;teamName&quot;</span><span class="p">],</span>
                        <span class="s2">&quot;totalRounds&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
                        <span class="s2">&quot;kills&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
                        <span class="s2">&quot;deaths&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
                        <span class="s2">&quot;kdr&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
                        <span class="s2">&quot;assists&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
                        <span class="s2">&quot;tradeKills&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
                        <span class="s2">&quot;teamKills&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
                        <span class="s2">&quot;suicides&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
                        <span class="s2">&quot;flashAssists&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
                        <span class="s2">&quot;totalDamageGiven&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
                        <span class="s2">&quot;totalDamageTaken&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
                        <span class="s2">&quot;totalTeamDamageGiven&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
                        <span class="s2">&quot;adr&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
                        <span class="s2">&quot;totalShots&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
                        <span class="s2">&quot;shotsHit&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
                        <span class="s2">&quot;accuracy&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
                        <span class="s2">&quot;rating&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
                        <span class="s2">&quot;kast&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
                        <span class="s2">&quot;hs&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
                        <span class="s2">&quot;hsPercent&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
                        <span class="s2">&quot;firstKills&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
                        <span class="s2">&quot;firstDeaths&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
                        <span class="s2">&quot;utilityDamage&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
                        <span class="s2">&quot;smokesThrown&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
                        <span class="s2">&quot;flashesThrown&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
                        <span class="s2">&quot;heThrown&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
                        <span class="s2">&quot;fireThrown&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
                        <span class="s2">&quot;enemiesFlashed&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
                        <span class="s2">&quot;teammatesFlashed&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
                        <span class="s2">&quot;blindTime&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
                        <span class="s2">&quot;plants&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
                        <span class="s2">&quot;defuses&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
                    <span class="p">}</span>
                    <span class="n">player_statistics</span><span class="p">[</span><span class="n">p</span><span class="p">[</span><span class="s2">&quot;steamID&quot;</span><span class="p">]][</span><span class="s2">&quot;totalRounds&quot;</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">player_statistics</span><span class="p">[</span><span class="n">p</span><span class="p">[</span><span class="s2">&quot;steamID&quot;</span><span class="p">]][</span><span class="s2">&quot;totalRounds&quot;</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">t_side</span><span class="p">[</span><span class="s2">&quot;players&quot;</span><span class="p">]:</span>
            <span class="k">if</span> <span class="n">p</span><span class="p">[</span><span class="s2">&quot;steamID&quot;</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">p</span><span class="p">[</span><span class="s2">&quot;steamID&quot;</span><span class="p">]</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">player_statistics</span><span class="p">:</span>
                    <span class="n">player_statistics</span><span class="p">[</span><span class="n">p</span><span class="p">[</span><span class="s2">&quot;steamID&quot;</span><span class="p">]]</span> <span class="o">=</span> <span class="p">{</span>
                        <span class="s2">&quot;steamID&quot;</span><span class="p">:</span> <span class="n">p</span><span class="p">[</span><span class="s2">&quot;steamID&quot;</span><span class="p">],</span>
                        <span class="s2">&quot;playerName&quot;</span><span class="p">:</span> <span class="n">p</span><span class="p">[</span><span class="s2">&quot;playerName&quot;</span><span class="p">],</span>
                        <span class="s2">&quot;teamName&quot;</span><span class="p">:</span> <span class="n">t_side</span><span class="p">[</span><span class="s2">&quot;teamName&quot;</span><span class="p">],</span>
                        <span class="s2">&quot;totalRounds&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
                        <span class="s2">&quot;kills&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
                        <span class="s2">&quot;deaths&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
                        <span class="s2">&quot;kdr&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
                        <span class="s2">&quot;assists&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
                        <span class="s2">&quot;tradeKills&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
                        <span class="s2">&quot;teamKills&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
                        <span class="s2">&quot;suicides&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
                        <span class="s2">&quot;flashAssists&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
                        <span class="s2">&quot;totalDamageGiven&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
                        <span class="s2">&quot;totalDamageTaken&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
                        <span class="s2">&quot;totalTeamDamageGiven&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
                        <span class="s2">&quot;adr&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
                        <span class="s2">&quot;totalShots&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
                        <span class="s2">&quot;shotsHit&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
                        <span class="s2">&quot;accuracy&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
                        <span class="s2">&quot;rating&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
                        <span class="s2">&quot;kast&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
                        <span class="s2">&quot;hs&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
                        <span class="s2">&quot;hsPercent&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
                        <span class="s2">&quot;firstKills&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
                        <span class="s2">&quot;firstDeaths&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
                        <span class="s2">&quot;utilityDamage&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
                        <span class="s2">&quot;smokesThrown&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
                        <span class="s2">&quot;flashesThrown&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
                        <span class="s2">&quot;heThrown&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
                        <span class="s2">&quot;fireThrown&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
                        <span class="s2">&quot;enemiesFlashed&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
                        <span class="s2">&quot;teammatesFlashed&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
                        <span class="s2">&quot;blindTime&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
                        <span class="s2">&quot;plants&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
                        <span class="s2">&quot;defuses&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
                    <span class="p">}</span>
                    <span class="n">player_statistics</span><span class="p">[</span><span class="n">p</span><span class="p">[</span><span class="s2">&quot;steamID&quot;</span><span class="p">]][</span><span class="s2">&quot;totalRounds&quot;</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">player_statistics</span><span class="p">[</span><span class="n">p</span><span class="p">[</span><span class="s2">&quot;steamID&quot;</span><span class="p">]][</span><span class="s2">&quot;totalRounds&quot;</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="n">kast</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">t_side</span><span class="p">[</span><span class="s2">&quot;players&quot;</span><span class="p">]:</span>
            <span class="k">if</span> <span class="n">p</span><span class="p">[</span><span class="s2">&quot;steamID&quot;</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">kast</span><span class="p">[</span><span class="n">p</span><span class="p">[</span><span class="s2">&quot;steamID&quot;</span><span class="p">]]</span> <span class="o">=</span> <span class="p">{}</span>
                <span class="n">kast</span><span class="p">[</span><span class="n">p</span><span class="p">[</span><span class="s2">&quot;steamID&quot;</span><span class="p">]][</span><span class="s2">&quot;k&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
                <span class="n">kast</span><span class="p">[</span><span class="n">p</span><span class="p">[</span><span class="s2">&quot;steamID&quot;</span><span class="p">]][</span><span class="s2">&quot;a&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
                <span class="n">kast</span><span class="p">[</span><span class="n">p</span><span class="p">[</span><span class="s2">&quot;steamID&quot;</span><span class="p">]][</span><span class="s2">&quot;s&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
                <span class="n">kast</span><span class="p">[</span><span class="n">p</span><span class="p">[</span><span class="s2">&quot;steamID&quot;</span><span class="p">]][</span><span class="s2">&quot;t&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">ct_side</span><span class="p">[</span><span class="s2">&quot;players&quot;</span><span class="p">]:</span>
            <span class="k">if</span> <span class="n">p</span><span class="p">[</span><span class="s2">&quot;steamID&quot;</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">kast</span><span class="p">[</span><span class="n">p</span><span class="p">[</span><span class="s2">&quot;steamID&quot;</span><span class="p">]]</span> <span class="o">=</span> <span class="p">{}</span>
                <span class="n">kast</span><span class="p">[</span><span class="n">p</span><span class="p">[</span><span class="s2">&quot;steamID&quot;</span><span class="p">]][</span><span class="s2">&quot;k&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
                <span class="n">kast</span><span class="p">[</span><span class="n">p</span><span class="p">[</span><span class="s2">&quot;steamID&quot;</span><span class="p">]][</span><span class="s2">&quot;a&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
                <span class="n">kast</span><span class="p">[</span><span class="n">p</span><span class="p">[</span><span class="s2">&quot;steamID&quot;</span><span class="p">]][</span><span class="s2">&quot;s&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
                <span class="n">kast</span><span class="p">[</span><span class="n">p</span><span class="p">[</span><span class="s2">&quot;steamID&quot;</span><span class="p">]][</span><span class="s2">&quot;t&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="c1"># Calculate kills</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">r</span><span class="p">[</span><span class="s2">&quot;kills&quot;</span><span class="p">]):</span>
            <span class="k">if</span> <span class="p">(</span>
                <span class="n">k</span><span class="p">[</span><span class="s2">&quot;attackerSteamID&quot;</span><span class="p">]</span>
                <span class="ow">and</span> <span class="ow">not</span> <span class="n">k</span><span class="p">[</span><span class="s2">&quot;isSuicide&quot;</span><span class="p">]</span>
                <span class="ow">and</span> <span class="ow">not</span> <span class="n">k</span><span class="p">[</span><span class="s2">&quot;isTeamkill&quot;</span><span class="p">]</span>
                <span class="ow">and</span> <span class="n">k</span><span class="p">[</span><span class="s2">&quot;attackerSteamID&quot;</span><span class="p">]</span> <span class="ow">in</span> <span class="n">player_statistics</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
            <span class="p">):</span>
                <span class="n">player_statistics</span><span class="p">[</span><span class="n">k</span><span class="p">[</span><span class="s2">&quot;attackerSteamID&quot;</span><span class="p">]][</span><span class="s2">&quot;kills&quot;</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="n">kast</span><span class="p">[</span><span class="n">k</span><span class="p">[</span><span class="s2">&quot;attackerSteamID&quot;</span><span class="p">]][</span><span class="s2">&quot;k&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="k">if</span> <span class="n">k</span><span class="p">[</span><span class="s2">&quot;victimSteamID&quot;</span><span class="p">]</span> <span class="ow">and</span> <span class="n">k</span><span class="p">[</span><span class="s2">&quot;victimSteamID&quot;</span><span class="p">]</span> <span class="ow">in</span> <span class="n">player_statistics</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                <span class="n">player_statistics</span><span class="p">[</span><span class="n">k</span><span class="p">[</span><span class="s2">&quot;victimSteamID&quot;</span><span class="p">]][</span><span class="s2">&quot;deaths&quot;</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="n">kast</span><span class="p">[</span><span class="n">k</span><span class="p">[</span><span class="s2">&quot;victimSteamID&quot;</span><span class="p">]][</span><span class="s2">&quot;s&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="k">if</span> <span class="p">(</span>
                <span class="n">k</span><span class="p">[</span><span class="s2">&quot;assisterSteamID&quot;</span><span class="p">]</span>
                <span class="ow">and</span> <span class="n">k</span><span class="p">[</span><span class="s2">&quot;assisterTeam&quot;</span><span class="p">]</span> <span class="o">!=</span> <span class="n">k</span><span class="p">[</span><span class="s2">&quot;victimTeam&quot;</span><span class="p">]</span>
                <span class="ow">and</span> <span class="n">k</span><span class="p">[</span><span class="s2">&quot;assisterSteamID&quot;</span><span class="p">]</span> <span class="ow">in</span> <span class="n">player_statistics</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
            <span class="p">):</span>
                <span class="n">player_statistics</span><span class="p">[</span><span class="n">k</span><span class="p">[</span><span class="s2">&quot;assisterSteamID&quot;</span><span class="p">]][</span><span class="s2">&quot;assists&quot;</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="n">kast</span><span class="p">[</span><span class="n">k</span><span class="p">[</span><span class="s2">&quot;assisterSteamID&quot;</span><span class="p">]][</span><span class="s2">&quot;a&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="k">if</span> <span class="p">(</span>
                <span class="n">k</span><span class="p">[</span><span class="s2">&quot;flashThrowerSteamID&quot;</span><span class="p">]</span>
                <span class="ow">and</span> <span class="n">k</span><span class="p">[</span><span class="s2">&quot;flashThrowerTeam&quot;</span><span class="p">]</span> <span class="o">!=</span> <span class="n">k</span><span class="p">[</span><span class="s2">&quot;victimTeam&quot;</span><span class="p">]</span>
                <span class="ow">and</span> <span class="n">k</span><span class="p">[</span><span class="s2">&quot;flashThrowerSteamID&quot;</span><span class="p">]</span> <span class="ow">in</span> <span class="n">player_statistics</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
            <span class="p">):</span>
                <span class="n">player_statistics</span><span class="p">[</span><span class="n">k</span><span class="p">[</span><span class="s2">&quot;flashThrowerSteamID&quot;</span><span class="p">]][</span><span class="s2">&quot;flashAssists&quot;</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="n">kast</span><span class="p">[</span><span class="n">k</span><span class="p">[</span><span class="s2">&quot;flashThrowerSteamID&quot;</span><span class="p">]][</span><span class="s2">&quot;a&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="k">if</span> <span class="p">(</span>
                <span class="n">k</span><span class="p">[</span><span class="s2">&quot;isTrade&quot;</span><span class="p">]</span>
                <span class="ow">and</span> <span class="n">k</span><span class="p">[</span><span class="s2">&quot;attackerSteamID&quot;</span><span class="p">]</span>
                <span class="ow">and</span> <span class="n">k</span><span class="p">[</span><span class="s2">&quot;attackerSteamID&quot;</span><span class="p">]</span> <span class="ow">in</span> <span class="n">player_statistics</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
            <span class="p">):</span>
                <span class="n">player_statistics</span><span class="p">[</span><span class="n">k</span><span class="p">[</span><span class="s2">&quot;attackerSteamID&quot;</span><span class="p">]][</span><span class="s2">&quot;tradeKills&quot;</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="n">kast</span><span class="p">[</span><span class="n">r</span><span class="p">[</span><span class="s2">&quot;kills&quot;</span><span class="p">][</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">][</span><span class="s2">&quot;victimSteamID&quot;</span><span class="p">]][</span><span class="s2">&quot;t&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="k">if</span> <span class="p">(</span>
                <span class="n">k</span><span class="p">[</span><span class="s2">&quot;isFirstKill&quot;</span><span class="p">]</span>
                <span class="ow">and</span> <span class="n">k</span><span class="p">[</span><span class="s2">&quot;attackerSteamID&quot;</span><span class="p">]</span>
                <span class="ow">and</span> <span class="n">k</span><span class="p">[</span><span class="s2">&quot;attackerSteamID&quot;</span><span class="p">]</span> <span class="ow">in</span> <span class="n">player_statistics</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
            <span class="p">):</span>
                <span class="n">player_statistics</span><span class="p">[</span><span class="n">k</span><span class="p">[</span><span class="s2">&quot;attackerSteamID&quot;</span><span class="p">]][</span><span class="s2">&quot;firstKills&quot;</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="n">player_statistics</span><span class="p">[</span><span class="n">k</span><span class="p">[</span><span class="s2">&quot;victimSteamID&quot;</span><span class="p">]][</span><span class="s2">&quot;firstDeaths&quot;</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="k">if</span> <span class="p">(</span>
                <span class="n">k</span><span class="p">[</span><span class="s2">&quot;isTeamkill&quot;</span><span class="p">]</span>
                <span class="ow">and</span> <span class="n">k</span><span class="p">[</span><span class="s2">&quot;attackerSteamID&quot;</span><span class="p">]</span>
                <span class="ow">and</span> <span class="n">k</span><span class="p">[</span><span class="s2">&quot;attackerSteamID&quot;</span><span class="p">]</span> <span class="ow">in</span> <span class="n">player_statistics</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
            <span class="p">):</span>
                <span class="n">player_statistics</span><span class="p">[</span><span class="n">k</span><span class="p">[</span><span class="s2">&quot;attackerSteamID&quot;</span><span class="p">]][</span><span class="s2">&quot;teamKills&quot;</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="k">if</span> <span class="p">(</span>
                <span class="n">k</span><span class="p">[</span><span class="s2">&quot;isHeadshot&quot;</span><span class="p">]</span>
                <span class="ow">and</span> <span class="n">k</span><span class="p">[</span><span class="s2">&quot;attackerSteamID&quot;</span><span class="p">]</span>
                <span class="ow">and</span> <span class="n">k</span><span class="p">[</span><span class="s2">&quot;attackerSteamID&quot;</span><span class="p">]</span> <span class="ow">in</span> <span class="n">player_statistics</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
            <span class="p">):</span>
                <span class="n">player_statistics</span><span class="p">[</span><span class="n">k</span><span class="p">[</span><span class="s2">&quot;attackerSteamID&quot;</span><span class="p">]][</span><span class="s2">&quot;hs&quot;</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="k">if</span> <span class="n">k</span><span class="p">[</span><span class="s2">&quot;isSuicide&quot;</span><span class="p">]</span> <span class="ow">and</span> <span class="n">k</span><span class="p">[</span><span class="s2">&quot;victimSteamID&quot;</span><span class="p">]</span> <span class="ow">in</span> <span class="n">player_statistics</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                <span class="n">player_statistics</span><span class="p">[</span><span class="n">k</span><span class="p">[</span><span class="s2">&quot;victimSteamID&quot;</span><span class="p">]][</span><span class="s2">&quot;suicides&quot;</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">r</span><span class="p">[</span><span class="s2">&quot;damages&quot;</span><span class="p">]:</span>
            <span class="k">if</span> <span class="p">(</span>
                <span class="n">d</span><span class="p">[</span><span class="s2">&quot;attackerSteamID&quot;</span><span class="p">]</span>
                <span class="ow">and</span> <span class="ow">not</span> <span class="n">d</span><span class="p">[</span><span class="s2">&quot;isFriendlyFire&quot;</span><span class="p">]</span>
                <span class="ow">and</span> <span class="n">d</span><span class="p">[</span><span class="s2">&quot;attackerSteamID&quot;</span><span class="p">]</span> <span class="ow">in</span> <span class="n">player_statistics</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
            <span class="p">):</span>
                <span class="n">player_statistics</span><span class="p">[</span><span class="n">d</span><span class="p">[</span><span class="s2">&quot;attackerSteamID&quot;</span><span class="p">]][</span><span class="s2">&quot;totalDamageGiven&quot;</span><span class="p">]</span> <span class="o">+=</span> <span class="n">d</span><span class="p">[</span>
                    <span class="s2">&quot;hpDamageTaken&quot;</span>
                <span class="p">]</span>
            <span class="k">if</span> <span class="n">d</span><span class="p">[</span><span class="s2">&quot;victimSteamID&quot;</span><span class="p">]</span> <span class="ow">and</span> <span class="n">d</span><span class="p">[</span><span class="s2">&quot;victimSteamID&quot;</span><span class="p">]</span> <span class="ow">in</span> <span class="n">player_statistics</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                <span class="n">player_statistics</span><span class="p">[</span><span class="n">d</span><span class="p">[</span><span class="s2">&quot;victimSteamID&quot;</span><span class="p">]][</span><span class="s2">&quot;totalDamageTaken&quot;</span><span class="p">]</span> <span class="o">+=</span> <span class="n">d</span><span class="p">[</span>
                    <span class="s2">&quot;hpDamageTaken&quot;</span>
                <span class="p">]</span>
            <span class="k">if</span> <span class="n">d</span><span class="p">[</span><span class="s2">&quot;isFriendlyFire&quot;</span><span class="p">]</span> <span class="ow">and</span> <span class="n">d</span><span class="p">[</span><span class="s2">&quot;attackerSteamID&quot;</span><span class="p">]</span> <span class="ow">in</span> <span class="n">player_statistics</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                <span class="n">player_statistics</span><span class="p">[</span><span class="n">d</span><span class="p">[</span><span class="s2">&quot;attackerSteamID&quot;</span><span class="p">]][</span><span class="s2">&quot;totalTeamDamageGiven&quot;</span><span class="p">]</span> <span class="o">+=</span> <span class="n">d</span><span class="p">[</span>
                    <span class="s2">&quot;hpDamageTaken&quot;</span>
                <span class="p">]</span>
            <span class="k">if</span> <span class="p">(</span>
                <span class="n">d</span><span class="p">[</span><span class="s2">&quot;weaponClass&quot;</span><span class="p">]</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;Unknown&quot;</span><span class="p">,</span> <span class="s2">&quot;Grenade&quot;</span><span class="p">,</span> <span class="s2">&quot;Equipment&quot;</span><span class="p">]</span>
                <span class="ow">and</span> <span class="n">d</span><span class="p">[</span><span class="s2">&quot;attackerSteamID&quot;</span><span class="p">]</span> <span class="ow">in</span> <span class="n">player_statistics</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
            <span class="p">):</span>
                <span class="n">player_statistics</span><span class="p">[</span><span class="n">d</span><span class="p">[</span><span class="s2">&quot;attackerSteamID&quot;</span><span class="p">]][</span><span class="s2">&quot;shotsHit&quot;</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="k">if</span> <span class="p">(</span>
                <span class="n">d</span><span class="p">[</span><span class="s2">&quot;weaponClass&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;Grenade&quot;</span>
                <span class="ow">and</span> <span class="n">d</span><span class="p">[</span><span class="s2">&quot;attackerSteamID&quot;</span><span class="p">]</span> <span class="ow">in</span> <span class="n">player_statistics</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
            <span class="p">):</span>
                <span class="n">player_statistics</span><span class="p">[</span><span class="n">d</span><span class="p">[</span><span class="s2">&quot;attackerSteamID&quot;</span><span class="p">]][</span><span class="s2">&quot;utilityDamage&quot;</span><span class="p">]</span> <span class="o">+=</span> <span class="n">d</span><span class="p">[</span>
                    <span class="s2">&quot;hpDamageTaken&quot;</span>
                <span class="p">]</span>
        <span class="k">for</span> <span class="n">w</span> <span class="ow">in</span> <span class="n">r</span><span class="p">[</span><span class="s2">&quot;weaponFires&quot;</span><span class="p">]:</span>
            <span class="k">if</span> <span class="n">w</span><span class="p">[</span><span class="s2">&quot;playerSteamID&quot;</span><span class="p">]</span> <span class="ow">in</span> <span class="n">player_statistics</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                <span class="n">player_statistics</span><span class="p">[</span><span class="n">w</span><span class="p">[</span><span class="s2">&quot;playerSteamID&quot;</span><span class="p">]][</span><span class="s2">&quot;totalShots&quot;</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">r</span><span class="p">[</span><span class="s2">&quot;flashes&quot;</span><span class="p">]:</span>
            <span class="k">if</span> <span class="p">(</span>
                <span class="n">f</span><span class="p">[</span><span class="s2">&quot;attackerSteamID&quot;</span><span class="p">]</span>
                <span class="ow">and</span> <span class="n">f</span><span class="p">[</span><span class="s2">&quot;attackerSteamID&quot;</span><span class="p">]</span> <span class="ow">in</span> <span class="n">player_statistics</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
            <span class="p">):</span>
                <span class="k">if</span> <span class="n">f</span><span class="p">[</span><span class="s2">&quot;attackerSide&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="n">f</span><span class="p">[</span><span class="s2">&quot;playerSide&quot;</span><span class="p">]:</span>
                    <span class="n">player_statistics</span><span class="p">[</span><span class="n">f</span><span class="p">[</span><span class="s2">&quot;attackerSteamID&quot;</span><span class="p">]][</span><span class="s2">&quot;teammatesFlashed&quot;</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">player_statistics</span><span class="p">[</span><span class="n">f</span><span class="p">[</span><span class="s2">&quot;attackerSteamID&quot;</span><span class="p">]][</span><span class="s2">&quot;enemiesFlashed&quot;</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
                    <span class="n">player_statistics</span><span class="p">[</span><span class="n">f</span><span class="p">[</span><span class="s2">&quot;attackerSteamID&quot;</span><span class="p">]][</span><span class="s2">&quot;blindTime&quot;</span><span class="p">]</span> <span class="o">+=</span> <span class="n">f</span><span class="p">[</span>
                        <span class="s2">&quot;flashDuration&quot;</span>
                    <span class="p">]</span>
        <span class="k">for</span> <span class="n">g</span> <span class="ow">in</span> <span class="n">r</span><span class="p">[</span><span class="s2">&quot;grenades&quot;</span><span class="p">]:</span>
            <span class="k">if</span> <span class="n">g</span><span class="p">[</span><span class="s2">&quot;throwerSteamID&quot;</span><span class="p">]</span> <span class="ow">and</span> <span class="n">g</span><span class="p">[</span><span class="s2">&quot;throwerSteamID&quot;</span><span class="p">]</span> <span class="ow">in</span> <span class="n">player_statistics</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                <span class="k">if</span> <span class="n">g</span><span class="p">[</span><span class="s2">&quot;grenadeType&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;Smoke Grenade&quot;</span><span class="p">:</span>
                    <span class="n">player_statistics</span><span class="p">[</span><span class="n">g</span><span class="p">[</span><span class="s2">&quot;throwerSteamID&quot;</span><span class="p">]][</span><span class="s2">&quot;smokesThrown&quot;</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="k">if</span> <span class="n">g</span><span class="p">[</span><span class="s2">&quot;grenadeType&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;Flashbang&quot;</span><span class="p">:</span>
                    <span class="n">player_statistics</span><span class="p">[</span><span class="n">g</span><span class="p">[</span><span class="s2">&quot;throwerSteamID&quot;</span><span class="p">]][</span><span class="s2">&quot;flashesThrown&quot;</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="k">if</span> <span class="n">g</span><span class="p">[</span><span class="s2">&quot;grenadeType&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;HE Grenade&quot;</span><span class="p">:</span>
                    <span class="n">player_statistics</span><span class="p">[</span><span class="n">g</span><span class="p">[</span><span class="s2">&quot;throwerSteamID&quot;</span><span class="p">]][</span><span class="s2">&quot;heThrown&quot;</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="k">if</span> <span class="n">g</span><span class="p">[</span><span class="s2">&quot;grenadeType&quot;</span><span class="p">]</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;Incendiary Grenade&quot;</span><span class="p">,</span> <span class="s2">&quot;Molotov&quot;</span><span class="p">]:</span>
                    <span class="n">player_statistics</span><span class="p">[</span><span class="n">g</span><span class="p">[</span><span class="s2">&quot;throwerSteamID&quot;</span><span class="p">]][</span><span class="s2">&quot;fireThrown&quot;</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="n">r</span><span class="p">[</span><span class="s2">&quot;bombEvents&quot;</span><span class="p">]:</span>
            <span class="k">if</span> <span class="n">b</span><span class="p">[</span><span class="s2">&quot;playerSteamID&quot;</span><span class="p">]</span> <span class="ow">and</span> <span class="n">b</span><span class="p">[</span><span class="s2">&quot;playerSteamID&quot;</span><span class="p">]</span> <span class="ow">in</span> <span class="n">player_statistics</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                <span class="k">if</span> <span class="n">b</span><span class="p">[</span><span class="s2">&quot;bombAction&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;plant&quot;</span><span class="p">:</span>
                    <span class="n">player_statistics</span><span class="p">[</span><span class="n">b</span><span class="p">[</span><span class="s2">&quot;playerSteamID&quot;</span><span class="p">]][</span><span class="s2">&quot;plants&quot;</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="k">if</span> <span class="n">b</span><span class="p">[</span><span class="s2">&quot;bombAction&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;defuse&quot;</span><span class="p">:</span>
                    <span class="n">player_statistics</span><span class="p">[</span><span class="n">b</span><span class="p">[</span><span class="s2">&quot;playerSteamID&quot;</span><span class="p">]][</span><span class="s2">&quot;defuses&quot;</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">for</span> <span class="n">player</span> <span class="ow">in</span> <span class="n">kast</span><span class="p">:</span>
            <span class="n">all_true</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="k">for</span> <span class="n">component</span> <span class="ow">in</span> <span class="n">kast</span><span class="p">[</span><span class="n">player</span><span class="p">]:</span>
                <span class="k">if</span> <span class="n">kast</span><span class="p">[</span><span class="n">player</span><span class="p">][</span><span class="n">component</span><span class="p">]:</span>
                    <span class="n">all_true</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="k">if</span> <span class="n">all_true</span><span class="p">:</span>
                <span class="n">player_statistics</span><span class="p">[</span><span class="n">player</span><span class="p">][</span><span class="s2">&quot;kast&quot;</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="k">for</span> <span class="n">player</span> <span class="ow">in</span> <span class="n">kast</span><span class="p">:</span>
        <span class="n">player_statistics</span><span class="p">[</span><span class="n">player</span><span class="p">][</span><span class="s2">&quot;kast&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span>
            <span class="mi">100</span>
            <span class="o">*</span> <span class="n">player_statistics</span><span class="p">[</span><span class="n">player</span><span class="p">][</span><span class="s2">&quot;kast&quot;</span><span class="p">]</span>
            <span class="o">/</span> <span class="n">player_statistics</span><span class="p">[</span><span class="n">player</span><span class="p">][</span><span class="s2">&quot;totalRounds&quot;</span><span class="p">],</span>
            <span class="mi">1</span><span class="p">,</span>
        <span class="p">)</span>
    <span class="k">for</span> <span class="n">player</span> <span class="ow">in</span> <span class="n">player_statistics</span><span class="p">:</span>
        <span class="n">player_statistics</span><span class="p">[</span><span class="n">player</span><span class="p">][</span><span class="s2">&quot;blindTime&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span>
            <span class="n">player_statistics</span><span class="p">[</span><span class="n">player</span><span class="p">][</span><span class="s2">&quot;blindTime&quot;</span><span class="p">],</span> <span class="mi">2</span>
        <span class="p">)</span>
    <span class="k">for</span> <span class="n">player</span> <span class="ow">in</span> <span class="n">player_statistics</span><span class="p">:</span>
        <span class="n">player_statistics</span><span class="p">[</span><span class="n">player</span><span class="p">][</span><span class="s2">&quot;kdr&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span>
            <span class="n">player_statistics</span><span class="p">[</span><span class="n">player</span><span class="p">][</span><span class="s2">&quot;kills&quot;</span><span class="p">]</span> <span class="o">/</span> <span class="n">player_statistics</span><span class="p">[</span><span class="n">player</span><span class="p">][</span><span class="s2">&quot;deaths&quot;</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">player_statistics</span><span class="p">[</span><span class="n">player</span><span class="p">][</span><span class="s2">&quot;deaths&quot;</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">0</span>
            <span class="k">else</span> <span class="n">player_statistics</span><span class="p">[</span><span class="n">player</span><span class="p">][</span><span class="s2">&quot;kills&quot;</span><span class="p">],</span>
            <span class="mi">2</span><span class="p">,</span>
        <span class="p">)</span>
    <span class="k">for</span> <span class="n">player</span> <span class="ow">in</span> <span class="n">player_statistics</span><span class="p">:</span>
        <span class="n">player_statistics</span><span class="p">[</span><span class="n">player</span><span class="p">][</span><span class="s2">&quot;adr&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span>
            <span class="n">player_statistics</span><span class="p">[</span><span class="n">player</span><span class="p">][</span><span class="s2">&quot;totalDamageGiven&quot;</span><span class="p">]</span>
            <span class="o">/</span> <span class="n">player_statistics</span><span class="p">[</span><span class="n">player</span><span class="p">][</span><span class="s2">&quot;totalRounds&quot;</span><span class="p">],</span>
            <span class="mi">1</span><span class="p">,</span>
        <span class="p">)</span>
    <span class="k">for</span> <span class="n">player</span> <span class="ow">in</span> <span class="n">player_statistics</span><span class="p">:</span>
        <span class="n">player_statistics</span><span class="p">[</span><span class="n">player</span><span class="p">][</span><span class="s2">&quot;accuracy&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span>
            <span class="n">player_statistics</span><span class="p">[</span><span class="n">player</span><span class="p">][</span><span class="s2">&quot;shotsHit&quot;</span><span class="p">]</span>
            <span class="o">/</span> <span class="n">player_statistics</span><span class="p">[</span><span class="n">player</span><span class="p">][</span><span class="s2">&quot;totalShots&quot;</span><span class="p">],</span>
            <span class="mi">2</span><span class="p">,</span>
        <span class="p">)</span>
    <span class="k">for</span> <span class="n">player</span> <span class="ow">in</span> <span class="n">player_statistics</span><span class="p">:</span>
        <span class="n">player_statistics</span><span class="p">[</span><span class="n">player</span><span class="p">][</span><span class="s2">&quot;hsPercent&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span>
            <span class="n">player_statistics</span><span class="p">[</span><span class="n">player</span><span class="p">][</span><span class="s2">&quot;hs&quot;</span><span class="p">]</span> <span class="o">/</span> <span class="n">player_statistics</span><span class="p">[</span><span class="n">player</span><span class="p">][</span><span class="s2">&quot;kills&quot;</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">player_statistics</span><span class="p">[</span><span class="n">player</span><span class="p">][</span><span class="s2">&quot;kills&quot;</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">0</span>
            <span class="k">else</span> <span class="mi">0</span><span class="p">,</span>
            <span class="mi">2</span><span class="p">,</span>
        <span class="p">)</span>
    <span class="k">for</span> <span class="n">player</span> <span class="ow">in</span> <span class="n">player_statistics</span><span class="p">:</span>
        <span class="n">impact</span> <span class="o">=</span> <span class="p">(</span>
            <span class="mf">2.13</span>
            <span class="o">*</span> <span class="p">(</span>
                <span class="n">player_statistics</span><span class="p">[</span><span class="n">player</span><span class="p">][</span><span class="s2">&quot;kills&quot;</span><span class="p">]</span>
                <span class="o">/</span> <span class="n">player_statistics</span><span class="p">[</span><span class="n">player</span><span class="p">][</span><span class="s2">&quot;totalRounds&quot;</span><span class="p">]</span>
            <span class="p">)</span>
            <span class="o">+</span> <span class="mf">0.42</span>
            <span class="o">*</span> <span class="p">(</span>
                <span class="n">player_statistics</span><span class="p">[</span><span class="n">player</span><span class="p">][</span><span class="s2">&quot;assists&quot;</span><span class="p">]</span>
                <span class="o">/</span> <span class="n">player_statistics</span><span class="p">[</span><span class="n">player</span><span class="p">][</span><span class="s2">&quot;totalRounds&quot;</span><span class="p">]</span>
            <span class="p">)</span>
            <span class="o">-</span> <span class="mf">0.41</span>
        <span class="p">)</span>
        <span class="n">player_statistics</span><span class="p">[</span><span class="n">player</span><span class="p">][</span><span class="s2">&quot;rating&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
            <span class="mf">0.0073</span> <span class="o">*</span> <span class="n">player_statistics</span><span class="p">[</span><span class="n">player</span><span class="p">][</span><span class="s2">&quot;kast&quot;</span><span class="p">]</span>
            <span class="o">+</span> <span class="mf">0.3591</span>
            <span class="o">*</span> <span class="p">(</span>
                <span class="n">player_statistics</span><span class="p">[</span><span class="n">player</span><span class="p">][</span><span class="s2">&quot;kills&quot;</span><span class="p">]</span>
                <span class="o">/</span> <span class="n">player_statistics</span><span class="p">[</span><span class="n">player</span><span class="p">][</span><span class="s2">&quot;totalRounds&quot;</span><span class="p">]</span>
            <span class="p">)</span>
            <span class="o">-</span> <span class="mf">0.5329</span>
            <span class="o">*</span> <span class="p">(</span>
                <span class="n">player_statistics</span><span class="p">[</span><span class="n">player</span><span class="p">][</span><span class="s2">&quot;deaths&quot;</span><span class="p">]</span>
                <span class="o">/</span> <span class="n">player_statistics</span><span class="p">[</span><span class="n">player</span><span class="p">][</span><span class="s2">&quot;totalRounds&quot;</span><span class="p">]</span>
            <span class="p">)</span>
            <span class="o">+</span> <span class="mf">0.2372</span> <span class="o">*</span> <span class="p">(</span><span class="n">impact</span><span class="p">)</span>
            <span class="o">+</span> <span class="mf">0.0032</span> <span class="o">*</span> <span class="p">(</span><span class="n">player_statistics</span><span class="p">[</span><span class="n">player</span><span class="p">][</span><span class="s2">&quot;adr&quot;</span><span class="p">])</span>
            <span class="o">+</span> <span class="mf">0.1587</span>
        <span class="p">)</span>
        <span class="n">player_statistics</span><span class="p">[</span><span class="n">player</span><span class="p">][</span><span class="s2">&quot;rating&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span>
            <span class="n">player_statistics</span><span class="p">[</span><span class="n">player</span><span class="p">][</span><span class="s2">&quot;rating&quot;</span><span class="p">],</span> <span class="mi">2</span>
        <span class="p">)</span>
    <span class="k">if</span> <span class="n">return_type</span> <span class="o">==</span> <span class="s2">&quot;df&quot;</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">(</span>
            <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
            <span class="o">.</span><span class="n">from_dict</span><span class="p">(</span><span class="n">player_statistics</span><span class="p">,</span> <span class="n">orient</span><span class="o">=</span><span class="s2">&quot;index&quot;</span><span class="p">)</span>
            <span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">player_statistics</span></div>


<span class="c1"># def accuracy(data):</span>
<span class="c1">#     &quot;&quot;&quot;_summary_</span>

<span class="c1">#     Args:</span>
<span class="c1">#         data (_type_): _description_</span>
<span class="c1">#     &quot;&quot;&quot;</span>
<span class="c1">#     accuracy_data = {}</span>
<span class="c1">#     for r in data:</span>
<span class="c1">#         if r[&quot;weaponFires&quot;]:</span>
<span class="c1">#             for w in r[&quot;weaponFires&quot;]:</span>
<span class="c1">#                 if w[&quot;playerSteamID&quot;] not in accuracy_data:</span>
<span class="c1">#                     accuracy_data[w[&quot;playerSteamID&quot;]] = {}</span>
<span class="c1">#                     accuracy_data[w[&quot;playerSteamID&quot;]][&quot;playerName&quot;] = w[&quot;playerName&quot;]</span>
<span class="c1">#                     accuracy_data[w[&quot;playerSteamID&quot;]][&quot;shotsFired&quot;] = 1</span>
<span class="c1">#                     accuracy_data[w[&quot;playerSteamID&quot;]][&quot;shotsHit&quot;] = 0</span>
<span class="c1">#                 else:</span>
<span class="c1">#                     accuracy_data[w[&quot;playerSteamID&quot;]][&quot;shotsFired&quot;] += 1</span>
<span class="c1">#             for d in r[&quot;damages&quot;]:</span>
<span class="c1">#                 if (</span>
<span class="c1">#                     (d[&quot;weaponClass&quot;] != &quot;Grenades&quot;)</span>
<span class="c1">#                     and (d[&quot;weaponClass&quot;] != &quot;Equipment&quot;)</span>
<span class="c1">#                     and (d[&quot;weaponClass&quot;] != &quot;Unknown&quot;)</span>
<span class="c1">#                 ):</span>
<span class="c1">#                     accuracy_data[w[&quot;playerSteamID&quot;]][&quot;shotsHit&quot;] += 1</span>
<span class="c1">#     return accuracy_data</span>


<span class="c1"># def kast(</span>
<span class="c1">#     data,</span>
<span class="c1">#     flash_assists=True,</span>
<span class="c1">#     return_type=&quot;json&quot;,</span>
<span class="c1"># ):</span>
<span class="c1">#     &quot;&quot;&quot;Creates KAST% for a given round/kill dataframe combination.</span>

<span class="c1">#     Args:</span>
<span class="c1">#         data (dict): Default</span>
<span class="c1">#         flash_assists (bool, optional): _description_. Defaults to True.</span>
<span class="c1">#         return_type (str, optional): _description_. Defaults to &quot;json&quot;.</span>
<span class="c1">#     &quot;&quot;&quot;</span>
<span class="c1">#     kast_data = {}</span>
<span class="c1">#     for r in data[&quot;gameRounds&quot;]:</span>
<span class="c1">#         if r[&quot;kills&quot;]:</span>
<span class="c1">#             for k in r[&quot;kills&quot;]:</span>
<span class="c1">#                 if k[&quot;attackerName&quot;] is not None:</span>
<span class="c1">#                     # Count kills</span>
<span class="c1">#                     if k[&quot;attackerName&quot;] in kast_data:</span>
<span class="c1">#                         kast_data[k[&quot;attackerName&quot;]][&quot;kills&quot;] += 1</span>
<span class="c1">#                     else:</span>
<span class="c1">#                         kast_data[k[&quot;attackerName&quot;]][&quot;kills&quot;] = 1</span>
<span class="c1">#                     # Count assists</span>
<span class="c1">#     pass</span>


<span class="c1"># def extract_num_filters(</span>
<span class="c1">#     filters: Dict[str, Union[List[bool], List[str]]], key: str</span>
<span class="c1"># ) -&gt; Tuple[List[str], List[float]]:</span>
<span class="c1">#     &quot;&quot;&quot;Extracts the numeric column filters from a key-value pair in a dictionary.</span>

<span class="c1">#     Extracts logical operators and numeric values from the column filters in the</span>
<span class="c1">#     the value of a specified key in the dictionary represented by filters.</span>

<span class="c1">#     Args:</span>
<span class="c1">#         filters: A dictionary where the keys are the columns of the dataframe</span>
<span class="c1">#             represented by df to filter the data by and the values are lists</span>
<span class="c1">#             that contain the column filters.</span>
<span class="c1">#         key: The key in the dictionary represented by filters for which the</span>
<span class="c1">#             numeric column filters should be extracted.</span>

<span class="c1">#     Returns:</span>
<span class="c1">#         A tuple of two lists where the first list contains all of the logical</span>
<span class="c1">#         operators in the column filters in the value of a specified key and the</span>
<span class="c1">#         second list contains all of the numeric values in the column filters in</span>
<span class="c1">#         the value of a specified key. For example:</span>
<span class="c1">#         ([&quot;&gt;&quot;, &quot;&lt;&quot;], [15.0, 25.0])</span>

<span class="c1">#     Raises:</span>
<span class="c1">#         ValueError: The value of the specified key contains a column filter of</span>
<span class="c1">#             type boolean.</span>
<span class="c1">#         Exception: The column filters in the value of the specified key contain</span>
<span class="c1">#             an invalid logical operator.</span>
<span class="c1">#         Exception: The column filters in the value of the specified key contain</span>
<span class="c1">#             an invalid numeric value.</span>
<span class="c1">#     &quot;&quot;&quot;</span>
<span class="c1">#     sign_list = []</span>
<span class="c1">#     val_list = []</span>
<span class="c1">#     for index in filters[key]:</span>
<span class="c1">#         if not isinstance(index, str):</span>
<span class="c1">#             raise ValueError(</span>
<span class="c1">#                 f&#39;Filter(s) for column &quot;{key}&quot; must be of type &#39; f&quot;string.&quot;</span>
<span class="c1">#             )</span>
<span class="c1">#         i = 0</span>
<span class="c1">#         sign = &quot;&quot;</span>
<span class="c1">#         while i &lt; len(index) and not index[i].isdecimal():</span>
<span class="c1">#             sign += index[i]</span>
<span class="c1">#             end_index = i</span>
<span class="c1">#             i += 1</span>
<span class="c1">#         if sign not in (&quot;==&quot;, &quot;!=&quot;, &quot;&lt;=&quot;, &quot;&gt;=&quot;, &quot;&lt;&quot;, &quot;&gt;&quot;):</span>
<span class="c1">#             raise Exception(</span>
<span class="c1">#                 f&#39;Invalid logical operator in filters for &quot;{key}&quot;&#39; f&quot; column.&quot;</span>
<span class="c1">#             )</span>
<span class="c1">#         sign_list.append(sign)</span>
<span class="c1">#         try:</span>
<span class="c1">#             val_list.append(float(index[end_index + 1 :]))</span>
<span class="c1">#         except ValueError as ve:</span>
<span class="c1">#             raise Exception(</span>
<span class="c1">#                 f&#39;Invalid numerical value in filters for &quot;{key}&quot; &#39; f&quot;column.&quot;</span>
<span class="c1">#             ) from ve</span>
<span class="c1">#     return sign_list, val_list</span>


<span class="c1"># def check_filters(df: pd.DataFrame, filters: Dict[str, Union[List[bool], List[str]]]):</span>
<span class="c1">#     &quot;&quot;&quot;Checks if the column filters are valid.</span>

<span class="c1">#     Iterates through each key-value pair in the dictionary represented by</span>
<span class="c1">#     filters and checks if the column filters for columns of type boolean are</span>
<span class="c1">#     of type boolean and the column filters for columns of type string are of</span>
<span class="c1">#     type string. Calls the function extract_numeric_filters to check if the</span>
<span class="c1">#     column filters for columns of type float and integer are valid.</span>

<span class="c1">#     Args:</span>
<span class="c1">#         df: A dataframe to be filtered.</span>
<span class="c1">#         filters: A dictionary where the keys are the columns of the dataframe</span>
<span class="c1">#             represented by df to filter the data by and the values are lists</span>
<span class="c1">#             that contain the column filters.</span>

<span class="c1">#     Raises:</span>
<span class="c1">#         ValueError: The value of a key corresponding to a column of type boolean</span>
<span class="c1">#             contains a column filter of a different type.</span>
<span class="c1">#         ValueError: The value of a key corresponding to a column of type string</span>
<span class="c1">#             contains a column filter of a different type.</span>
<span class="c1">#     &quot;&quot;&quot;</span>
<span class="c1">#     for key in filters:</span>
<span class="c1">#         if df.dtypes[key] == &quot;bool&quot;:</span>
<span class="c1">#             for index in filters[key]:</span>
<span class="c1">#                 if not isinstance(index, bool):</span>
<span class="c1">#                     raise ValueError(</span>
<span class="c1">#                         f&#39;Filter(s) for column &quot;{key}&quot; must be &#39; f&quot;of type boolean&quot;</span>
<span class="c1">#                     )</span>
<span class="c1">#         elif df.dtypes[key] == &quot;O&quot;:</span>
<span class="c1">#             for index in filters[key]:</span>
<span class="c1">#                 if not isinstance(index, str):</span>
<span class="c1">#                     raise ValueError(</span>
<span class="c1">#                         f&#39;Filter(s) for column &quot;{key}&quot; must be &#39; f&quot;of type string&quot;</span>
<span class="c1">#                     )</span>
<span class="c1">#         else:</span>
<span class="c1">#             extract_num_filters(filters, key)</span>


<span class="c1"># def num_filter_df(df: pd.DataFrame, col: str, sign: str, val: float) -&gt; pd.DataFrame:</span>
<span class="c1">#     &quot;&quot;&quot;Filters numeric data in a dataframe.</span>

<span class="c1">#     Args:</span>
<span class="c1">#         df: A dataframe to be filtered.</span>
<span class="c1">#         col: A column of the dataframe represented by df to filter by.</span>
<span class="c1">#         sign: A logical operator representing the operation to filter the</span>
<span class="c1">#             dataframe represented by df by.</span>
<span class="c1">#         val: A numeric value to filter the dataframe represented by df by.</span>

<span class="c1">#     Returns:</span>
<span class="c1">#         A filtered dataframe.</span>
<span class="c1">#     &quot;&quot;&quot;</span>
<span class="c1">#     ops = {</span>
<span class="c1">#         &quot;==&quot;: operator.eq(df[col], val),</span>
<span class="c1">#         &quot;!=&quot;: operator.ne(df[col], val),</span>
<span class="c1">#         &quot;&lt;=&quot;: operator.le(df[col], val),</span>
<span class="c1">#         &quot;&gt;=&quot;: operator.ge(df[col], val),</span>
<span class="c1">#         &quot;&lt;&quot;: operator.lt(df[col], val),</span>
<span class="c1">#         &quot;&gt;&quot;: operator.gt(df[col], val),</span>
<span class="c1">#     }</span>
<span class="c1">#     filtered_df = df.loc[ops[sign]]</span>
<span class="c1">#     return filtered_df</span>


<span class="c1"># def filter_df(</span>
<span class="c1">#     df: pd.DataFrame, filters: Dict[str, Union[List[bool], List[str]]]</span>
<span class="c1"># ) -&gt; pd.DataFrame:</span>
<span class="c1">#     &quot;&quot;&quot;Filters data in a dataframe.</span>

<span class="c1">#     Filters a dataframe for columns of type boolean and string and calls the</span>
<span class="c1">#     function num_filter_df to filter a dataframe for columns of type float</span>
<span class="c1">#     and integer.</span>

<span class="c1">#     Args:</span>
<span class="c1">#         df: A dataframe to be filtered.</span>
<span class="c1">#         filters: A dictionary where the keys are the columns of the dataframe</span>
<span class="c1">#             represented by df to filter the data by and the values are lists</span>
<span class="c1">#             that contain the column filters.</span>

<span class="c1">#     Returns:</span>
<span class="c1">#         A filtered dataframe.</span>
<span class="c1">#     &quot;&quot;&quot;</span>
<span class="c1">#     df_copy = df.copy()</span>
<span class="c1">#     check_filters(df_copy, filters)</span>
<span class="c1">#     for key in filters:</span>
<span class="c1">#         if df_copy.dtypes[key] == &quot;bool&quot; or df_copy.dtypes[key] == &quot;O&quot;:</span>
<span class="c1">#             df_copy = df_copy.loc[df_copy[key].isin(filters[key])]</span>
<span class="c1">#         else:</span>
<span class="c1">#             i = 0</span>
<span class="c1">#             for _ in extract_num_filters(filters, key)[0]:</span>
<span class="c1">#                 val = extract_num_filters(filters, key)[1][i]</span>
<span class="c1">#                 df_copy = num_filter_df(</span>
<span class="c1">#                     df_copy, key, extract_num_filters(filters, key)[0][i], val</span>
<span class="c1">#                 )</span>
<span class="c1">#                 i += 1</span>
<span class="c1">#     return df_copy</span>


<span class="c1"># def calc_stats(</span>
<span class="c1">#     df: pd.DataFrame,</span>
<span class="c1">#     filters: Dict[str, Union[List[bool], List[str]]],</span>
<span class="c1">#     col_to_groupby: List[str],</span>
<span class="c1">#     col_to_agg: List[str],</span>
<span class="c1">#     agg: List[List[str]],</span>
<span class="c1">#     col_names: List[str],</span>
<span class="c1"># ) -&gt; pd.DataFrame:</span>
<span class="c1">#     &quot;&quot;&quot;Calculates statistics for a dataframe.</span>

<span class="c1">#     Calls the function filter_df to filter a data in dataframe and then performs</span>
<span class="c1">#     groupby and aggregation operations on the dataframe and renames the columns.</span>

<span class="c1">#     Args:</span>
<span class="c1">#         df: A dataframe from which statistics should be calculated.</span>
<span class="c1">#         filters: A dictionary where the keys are the columns of the dataframe</span>
<span class="c1">#             represented by df to filter the data by and the values are lists</span>
<span class="c1">#             that contain the column filters.</span>
<span class="c1">#         col_to_groupby: Columns of the dataframe represented by df to perform</span>
<span class="c1">#             the groupby operation on.</span>
<span class="c1">#         col_to_agg: Columns of the dataframe represented by df to perform</span>
<span class="c1">#             aggregation operations on.</span>
<span class="c1">#         agg: The aggregation operations to be applied to the columns in the list</span>
<span class="c1">#             represented by col_to_agg.</span>
<span class="c1">#         col_names: Column names for the returned dataframe.</span>

<span class="c1">#     Returns:</span>
<span class="c1">#         A dataframe with the specified statistics.</span>
<span class="c1">#     &quot;&quot;&quot;</span>
<span class="c1">#     df_copy = filter_df(df, filters)</span>
<span class="c1">#     agg_dict = dict(zip(col_to_agg, agg))</span>
<span class="c1">#     if col_to_agg:</span>
<span class="c1">#         df_copy = df_copy.groupby(col_to_groupby).agg(agg_dict).reset_index()</span>
<span class="c1">#     df_copy.columns = col_names</span>
<span class="c1">#     return df_copy</span>


<span class="c1"># def accuracy(</span>
<span class="c1">#     damage_data: pd.DataFrame,</span>
<span class="c1">#     weapon_fire_data: pd.DataFrame,</span>
<span class="c1">#     team: bool = False,</span>
<span class="c1">#     damage_filters: Dict[str, Union[List[bool], List[str]]] = {},</span>
<span class="c1">#     weapon_fire_filters: Dict[str, Union[List[bool], List[str]]] = {},</span>
<span class="c1"># ) -&gt; pd.DataFrame:</span>
<span class="c1">#     &quot;&quot;&quot;Returns a dataframe with accuracy statistics.</span>

<span class="c1">#     Args:</span>
<span class="c1">#         damage_data: A dataframe with damage data.</span>
<span class="c1">#         weapon_fire_data: A dataframe with weapon fire data.</span>
<span class="c1">#         team: A boolean specifying wheter to calculate statistics for each team</span>
<span class="c1">#             or for each player. The default is to calculate statistics for</span>
<span class="c1">#             each player.</span>
<span class="c1">#         damage_filters: A dictionary where the keys are the columns of the</span>
<span class="c1">#             dataframe represented by damage_data to filter the damage data by</span>
<span class="c1">#             and the values are lists that contain the column filters.</span>
<span class="c1">#         weapon_fire_filters: A dictionary where the keys are the columns of the</span>
<span class="c1">#             dataframe represented by weapon_fires to filter the weapon fire data</span>
<span class="c1">#             by and the values are lists that contain the column filters.</span>

<span class="c1">#     Returns:</span>
<span class="c1">#         A dataframe with the total shots, strafe shots, hits, accuracy (hits/total number of shots), headshot accuracy (head hits/total number of shots)</span>
<span class="c1">#     &quot;&quot;&quot;</span>
<span class="c1">#     stats = [&quot;playerName&quot;, &quot;attackerName&quot;, &quot;Player&quot;]</span>
<span class="c1">#     if team:</span>
<span class="c1">#         stats = [&quot;playerTeam&quot;, &quot;attackerTeam&quot;, &quot;Team&quot;]</span>
<span class="c1">#     weapon_fires = calc_stats(</span>
<span class="c1">#         weapon_fire_data,</span>
<span class="c1">#         weapon_fire_filters,</span>
<span class="c1">#         [stats[0]],</span>
<span class="c1">#         [stats[0]],</span>
<span class="c1">#         [[&quot;size&quot;]],</span>
<span class="c1">#         [stats[2], &quot;Weapon Fires&quot;],</span>
<span class="c1">#     )</span>
<span class="c1">#     strafe_fires = calc_stats(</span>
<span class="c1">#         weapon_fire_data.loc[weapon_fire_data[&quot;playerStrafe&quot;] == True],</span>
<span class="c1">#         weapon_fire_filters,</span>
<span class="c1">#         [stats[0]],</span>
<span class="c1">#         [stats[0]],</span>
<span class="c1">#         [[&quot;size&quot;]],</span>
<span class="c1">#         [stats[2], &quot;Strafe Fires&quot;],</span>
<span class="c1">#     )</span>
<span class="c1">#     hits = calc_stats(</span>
<span class="c1">#         damage_data.loc[damage_data[&quot;attackerTeam&quot;] != damage_data[&quot;victimTeam&quot;]],</span>
<span class="c1">#         damage_filters,</span>
<span class="c1">#         [stats[1]],</span>
<span class="c1">#         [stats[1]],</span>
<span class="c1">#         [[&quot;size&quot;]],</span>
<span class="c1">#         [stats[2], &quot;Hits&quot;],</span>
<span class="c1">#     )</span>
<span class="c1">#     headshots = calc_stats(</span>
<span class="c1">#         damage_data.loc[</span>
<span class="c1">#             (damage_data[&quot;attackerTeam&quot;] != damage_data[&quot;victimTeam&quot;])</span>
<span class="c1">#             &amp; (damage_data[&quot;hitGroup&quot;] == &quot;Head&quot;)</span>
<span class="c1">#         ],</span>
<span class="c1">#         damage_filters,</span>
<span class="c1">#         [stats[1]],</span>
<span class="c1">#         [stats[1]],</span>
<span class="c1">#         [[&quot;size&quot;]],</span>
<span class="c1">#         [stats[2], &quot;Headshots&quot;],</span>
<span class="c1">#     )</span>
<span class="c1">#     acc = weapon_fires.merge(strafe_fires, how=&quot;outer&quot;)  # .fillna(0)</span>
<span class="c1">#     acc = acc.merge(hits, how=&quot;outer&quot;)  # .fillna(0)</span>
<span class="c1">#     acc = acc.merge(headshots, how=&quot;outer&quot;)  # .fillna(0)</span>
<span class="c1">#     acc[&quot;Strafe%&quot;] = acc[&quot;Strafe Fires&quot;] / acc[&quot;Weapon Fires&quot;]</span>
<span class="c1">#     acc[&quot;ACC%&quot;] = acc[&quot;Hits&quot;] / acc[&quot;Weapon Fires&quot;]</span>
<span class="c1">#     acc[&quot;HS ACC%&quot;] = acc[&quot;Headshots&quot;] / acc[&quot;Weapon Fires&quot;]</span>
<span class="c1">#     acc = acc[[stats[2], &quot;Weapon Fires&quot;, &quot;Strafe%&quot;, &quot;ACC%&quot;, &quot;HS ACC%&quot;]]</span>
<span class="c1">#     acc.sort_values(by=&quot;ACC%&quot;, ascending=False, inplace=True)</span>
<span class="c1">#     acc.reset_index(drop=True, inplace=True)</span>
<span class="c1">#     return acc</span>


<span class="c1"># def kast(</span>
<span class="c1">#     kill_data: pd.DataFrame,</span>
<span class="c1">#     kast_string: str = &quot;KAST&quot;,</span>
<span class="c1">#     flash_assists: bool = True,</span>
<span class="c1">#     kill_filters: Dict[str, Union[List[bool], List[str]]] = {},</span>
<span class="c1">#     death_filters: Dict[str, Union[List[bool], List[str]]] = {},</span>
<span class="c1"># ) -&gt; pd.DataFrame:</span>
<span class="c1">#     &quot;&quot;&quot;Returns a dataframe with KAST statistics.</span>

<span class="c1">#     Args:</span>
<span class="c1">#         kill_data: A dataframe with kill data.</span>
<span class="c1">#         kast_string: A string specifying which combination of KAST statistics</span>
<span class="c1">#             to use.</span>
<span class="c1">#         flash_assists: A boolean specifying if flash assists are to be</span>
<span class="c1">#             counted as assists or not.</span>
<span class="c1">#         kill_filters: A dictionary where the keys are the columns of the</span>
<span class="c1">#             dataframe represented by kill_data to filter the kill data by and</span>
<span class="c1">#             the values are lists that contain the column filters.</span>
<span class="c1">#         death_filters: A dictionary where the keys are the columns of the</span>
<span class="c1">#             dataframe represented by kill_data to filter the death data by and</span>
<span class="c1">#             the values are lists that contain the column filters.</span>

<span class="c1">#     Returns:</span>
<span class="c1">#         A dataframe containing the percentage of a player&#39;s rounds with at least one of (K)ill, (A)ssist, (S)urvival and (T)rades.</span>
<span class="c1">#     &quot;&quot;&quot;</span>
<span class="c1">#     columns = [&quot;Player&quot;, f&quot;{kast_string.upper()}%&quot;]</span>
<span class="c1">#     kast_counts = {}</span>
<span class="c1">#     kast_rounds = {}</span>
<span class="c1">#     for stat in kast_string.upper():</span>
<span class="c1">#         columns.append(stat)</span>
<span class="c1">#     kill_data = kill_data[~kill_data[&quot;attackerName&quot;].isna()]</span>
<span class="c1">#     killers = calc_stats(</span>
<span class="c1">#         kill_data.loc[</span>
<span class="c1">#             (kill_data[&quot;attackerTeam&quot;] != kill_data[&quot;victimTeam&quot;])</span>
<span class="c1">#             &amp; (kill_data[&quot;attackerTeam&quot;].notnull())</span>
<span class="c1">#         ],</span>
<span class="c1">#         kill_filters,</span>
<span class="c1">#         [&quot;roundNum&quot;],</span>
<span class="c1">#         [&quot;attackerName&quot;],</span>
<span class="c1">#         [[&quot;sum&quot;]],</span>
<span class="c1">#         [&quot;RoundNum&quot;, &quot;Killers&quot;],</span>
<span class="c1">#     )</span>
<span class="c1">#     victims = calc_stats(</span>
<span class="c1">#         kill_data,</span>
<span class="c1">#         kill_filters,</span>
<span class="c1">#         [&quot;roundNum&quot;],</span>
<span class="c1">#         [&quot;victimName&quot;],</span>
<span class="c1">#         [[&quot;sum&quot;]],</span>
<span class="c1">#         [&quot;RoundNum&quot;, &quot;Victims&quot;],</span>
<span class="c1">#     )</span>
<span class="c1">#     assisters = calc_stats(</span>
<span class="c1">#         kill_data.loc[</span>
<span class="c1">#             (kill_data[&quot;assisterTeam&quot;] != kill_data[&quot;victimTeam&quot;])</span>
<span class="c1">#             &amp; (kill_data[&quot;assisterTeam&quot;].notnull())</span>
<span class="c1">#         ],  # .fillna(&quot;&quot;),</span>
<span class="c1">#         kill_filters,</span>
<span class="c1">#         [&quot;roundNum&quot;],</span>
<span class="c1">#         [&quot;assisterName&quot;],</span>
<span class="c1">#         [[&quot;sum&quot;]],</span>
<span class="c1">#         [&quot;RoundNum&quot;, &quot;Assisters&quot;],</span>
<span class="c1">#     )</span>
<span class="c1">#     traded = calc_stats(</span>
<span class="c1">#         kill_data.loc[</span>
<span class="c1">#             (kill_data[&quot;attackerTeam&quot;] != kill_data[&quot;victimTeam&quot;])</span>
<span class="c1">#             &amp; (kill_data[&quot;isTrade&quot;] == True)</span>
<span class="c1">#             &amp; (kill_data[&quot;attackerTeam&quot;].notnull())</span>
<span class="c1">#         ],  # .fillna(&quot;&quot;),</span>
<span class="c1">#         kill_filters,</span>
<span class="c1">#         [&quot;roundNum&quot;],</span>
<span class="c1">#         [&quot;playerTradedName&quot;],</span>
<span class="c1">#         [[&quot;sum&quot;]],</span>
<span class="c1">#         [&quot;RoundNum&quot;, &quot;Traded&quot;],</span>
<span class="c1">#     )</span>
<span class="c1">#     if flash_assists:</span>
<span class="c1">#         flash_assisters = calc_stats(</span>
<span class="c1">#             kill_data.loc[</span>
<span class="c1">#                 (kill_data[&quot;flashThrowerTeam&quot;] != kill_data[&quot;victimTeam&quot;])</span>
<span class="c1">#                 &amp; (kill_data[&quot;flashThrowerTeam&quot;].notnull())</span>
<span class="c1">#             ],  # .fillna(&quot;&quot;),</span>
<span class="c1">#             kill_filters,</span>
<span class="c1">#             [&quot;roundNum&quot;],</span>
<span class="c1">#             [&quot;flashThrowerName&quot;],</span>
<span class="c1">#             [[&quot;sum&quot;]],</span>
<span class="c1">#             [&quot;RoundNum&quot;, &quot;Flash Assisters&quot;],</span>
<span class="c1">#         )</span>
<span class="c1">#         assisters = assisters.merge(flash_assisters, on=&quot;RoundNum&quot;)</span>
<span class="c1">#         assisters[&quot;Assisters&quot;] = assisters[&quot;Assisters&quot;] + assisters[&quot;Flash Assisters&quot;]</span>
<span class="c1">#         assisters = assisters[[&quot;RoundNum&quot;, &quot;Assisters&quot;]]</span>
<span class="c1">#     kast_data = killers.merge(assisters, how=&quot;outer&quot;)  # .fillna(&quot;&quot;)</span>
<span class="c1">#     kast_data = kast_data.merge(victims, how=&quot;outer&quot;)  # .fillna(&quot;&quot;)</span>
<span class="c1">#     kast_data = kast_data.merge(traded, how=&quot;outer&quot;)  # .fillna(&quot;&quot;)</span>
<span class="c1">#     killer_names = kill_data[&quot;attackerName&quot;].tolist()</span>
<span class="c1">#     cleaned_killer_names = []</span>
<span class="c1">#     for x in killer_names:</span>
<span class="c1">#         if x != None:</span>
<span class="c1">#             cleaned_killer_names.append(x)</span>
<span class="c1">#     cleaned_killer_names = pd.Series(cleaned_killer_names)</span>
<span class="c1">#     for player in cleaned_killer_names:</span>
<span class="c1">#         kast_counts[player] = [[0, 0, 0, 0] for i in range(len(kast_data))]</span>
<span class="c1">#         kast_rounds[player] = [0, 0, 0, 0, 0]</span>
<span class="c1">#     for rd in kast_data.index:</span>
<span class="c1">#         for player in kast_counts:</span>
<span class="c1">#             if &quot;K&quot; in kast_string.upper():</span>
<span class="c1">#                 kast_counts[player][rd][0] = kast_data.iloc[rd][&quot;Killers&quot;].count(player)</span>
<span class="c1">#                 kast_rounds[player][1] += kast_data.iloc[rd][&quot;Killers&quot;].count(player)</span>
<span class="c1">#             if &quot;A&quot; in kast_string.upper():</span>
<span class="c1">#                 kast_counts[player][rd][1] = kast_data.iloc[rd][&quot;Assisters&quot;].count(</span>
<span class="c1">#                     player</span>
<span class="c1">#                 )</span>
<span class="c1">#                 kast_rounds[player][2] += kast_data.iloc[rd][&quot;Assisters&quot;].count(player)</span>
<span class="c1">#             if &quot;S&quot; in kast_string.upper():</span>
<span class="c1">#                 if player not in kast_data.iloc[rd][&quot;Victims&quot;]:</span>
<span class="c1">#                     kast_counts[player][rd][2] = 1</span>
<span class="c1">#                     kast_rounds[player][3] += 1</span>
<span class="c1">#             if &quot;T&quot; in kast_string.upper():</span>
<span class="c1">#                 kast_counts[player][rd][3] = kast_data.iloc[rd][&quot;Traded&quot;].count(player)</span>
<span class="c1">#                 kast_rounds[player][4] += kast_data.iloc[rd][&quot;Traded&quot;].count(player)</span>
<span class="c1">#     for player in kast_rounds:</span>
<span class="c1">#         for rd in kast_counts[player]:</span>
<span class="c1">#             if any(rd):</span>
<span class="c1">#                 kast_rounds[player][0] += 1</span>
<span class="c1">#         kast_rounds[player][0] /= len(kast_data)</span>
<span class="c1">#     kast = pd.DataFrame.from_dict(kast_rounds, orient=&quot;index&quot;).reset_index()</span>
<span class="c1">#     kast.columns = [&quot;Player&quot;, f&quot;{kast_string.upper()}%&quot;, &quot;K&quot;, &quot;A&quot;, &quot;S&quot;, &quot;T&quot;]</span>
<span class="c1">#     kast = kast[columns]</span>
<span class="c1">#     kast  # .fillna(0, inplace=True)</span>
<span class="c1">#     kast.sort_values(by=f&quot;{kast_string.upper()}%&quot;, ascending=False, inplace=True)</span>
<span class="c1">#     kast.reset_index(drop=True, inplace=True)</span>
<span class="c1">#     return kast</span>


<span class="c1"># def kill_stats(</span>
<span class="c1">#     damage_data: pd.DataFrame,</span>
<span class="c1">#     kill_data: pd.DataFrame,</span>
<span class="c1">#     round_data: pd.DataFrame,</span>
<span class="c1">#     weapon_fire_data: pd.DataFrame,</span>
<span class="c1">#     team: bool = False,</span>
<span class="c1">#     damage_filters: Dict[str, Union[List[bool], List[str]]] = {},</span>
<span class="c1">#     kill_filters: Dict[str, Union[List[bool], List[str]]] = {},</span>
<span class="c1">#     death_filters: Dict[str, Union[List[bool], List[str]]] = {},</span>
<span class="c1">#     round_filters: Dict[str, Union[List[bool], List[str]]] = {},</span>
<span class="c1">#     weapon_fire_filters: Dict[str, Union[List[bool], List[str]]] = {},</span>
<span class="c1"># ) -&gt; pd.DataFrame:</span>
<span class="c1">#     &quot;&quot;&quot;Returns a dataframe with kill statistics.</span>

<span class="c1">#     Args:</span>
<span class="c1">#         damage_data: A dataframe with damage data.</span>
<span class="c1">#         kill_data: A dataframe with kill data.</span>
<span class="c1">#         round_data: A dataframe with round data.</span>
<span class="c1">#         weapon_fire_data: A dataframe with weapon fire data.</span>
<span class="c1">#             where each round is a dictionary.</span>
<span class="c1">#         team: A boolean specifying whether to calculate statistics for each team</span>
<span class="c1">#             or for each player. The default is to calculate statistics for</span>
<span class="c1">#             each player.</span>
<span class="c1">#         damage_filters: A dictionary where the keys are the columns of the</span>
<span class="c1">#             dataframe represented by damage_data to filter the damage data by</span>
<span class="c1">#             and the values are lists that contain the column filters.</span>
<span class="c1">#         kill_filters: A dictionary where the keys are the columns of the</span>
<span class="c1">#             dataframe represented by kill_data to filter the kill data by and</span>
<span class="c1">#             the values are lists that contain the column filters.</span>
<span class="c1">#         death_filters: A dictionary where the keys are the columns of the</span>
<span class="c1">#             dataframe represented by kill_data to filter the death data by and</span>
<span class="c1">#             the values are lists that contain the column filters.</span>
<span class="c1">#         round_filters: A dictionary where the keys are the columns of the</span>
<span class="c1">#             dataframe represented by round_data to filter the round data by and</span>
<span class="c1">#             the values are lists that contain the column filters.</span>
<span class="c1">#         weapon_fire_filters: A dictionary where the keys are the columns of the</span>
<span class="c1">#             dataframe represented by weapon_fires to filter the weapon fire data</span>
<span class="c1">#             by and the values are lists that contain the column filters.</span>

<span class="c1">#     Returns:</span>
<span class="c1">#         A dataframe with kills, deaths, assists, flash assists, first kills/deaths, headshots, headshot kills/total kills, KAST and accuracy statistics.</span>
<span class="c1">#     &quot;&quot;&quot;</span>
<span class="c1">#     stats = [&quot;attackerName&quot;, &quot;victimName&quot;, &quot;assisterName&quot;, &quot;flashThrowerName&quot;, &quot;Player&quot;]</span>
<span class="c1">#     if team:</span>
<span class="c1">#         stats = [</span>
<span class="c1">#             &quot;attackerTeam&quot;,</span>
<span class="c1">#             &quot;victimTeam&quot;,</span>
<span class="c1">#             &quot;assisterTeam&quot;,</span>
<span class="c1">#             &quot;flashThrowerTeam&quot;,</span>
<span class="c1">#             &quot;Team&quot;,</span>
<span class="c1">#         ]</span>
<span class="c1">#     kills = calc_stats(</span>
<span class="c1">#         kill_data.loc[kill_data[&quot;attackerTeam&quot;] != kill_data[&quot;victimTeam&quot;]],</span>
<span class="c1">#         kill_filters,</span>
<span class="c1">#         [stats[0]],</span>
<span class="c1">#         [stats[0]],</span>
<span class="c1">#         [[&quot;size&quot;]],</span>
<span class="c1">#         [stats[4], &quot;K&quot;],</span>
<span class="c1">#     )</span>
<span class="c1">#     deaths = calc_stats(</span>
<span class="c1">#         kill_data,</span>
<span class="c1">#         death_filters,</span>
<span class="c1">#         [stats[1]],</span>
<span class="c1">#         [stats[1]],</span>
<span class="c1">#         [[&quot;size&quot;]],</span>
<span class="c1">#         [stats[4], &quot;D&quot;],</span>
<span class="c1">#     )</span>
<span class="c1">#     assists = calc_stats(</span>
<span class="c1">#         kill_data.loc[kill_data[&quot;assisterTeam&quot;] != kill_data[&quot;victimTeam&quot;]],</span>
<span class="c1">#         kill_filters,</span>
<span class="c1">#         [stats[2]],</span>
<span class="c1">#         [stats[2]],</span>
<span class="c1">#         [[&quot;size&quot;]],</span>
<span class="c1">#         [stats[4], &quot;A&quot;],</span>
<span class="c1">#     )</span>
<span class="c1">#     flash_assists = calc_stats(</span>
<span class="c1">#         kill_data.loc[kill_data[&quot;flashThrowerTeam&quot;] != kill_data[&quot;victimTeam&quot;]],</span>
<span class="c1">#         kill_filters,</span>
<span class="c1">#         [stats[3]],</span>
<span class="c1">#         [stats[3]],</span>
<span class="c1">#         [[&quot;size&quot;]],</span>
<span class="c1">#         [stats[4], &quot;FA&quot;],</span>
<span class="c1">#     )</span>
<span class="c1">#     first_kills = calc_stats(</span>
<span class="c1">#         kill_data.loc[</span>
<span class="c1">#             (kill_data[&quot;attackerTeam&quot;] != kill_data[&quot;victimTeam&quot;])</span>
<span class="c1">#             &amp; (kill_data[&quot;isFirstKill&quot;] == True)</span>
<span class="c1">#         ],</span>
<span class="c1">#         kill_filters,</span>
<span class="c1">#         [stats[0]],</span>
<span class="c1">#         [stats[0]],</span>
<span class="c1">#         [[&quot;size&quot;]],</span>
<span class="c1">#         [stats[4], &quot;FK&quot;],</span>
<span class="c1">#     )</span>
<span class="c1">#     first_deaths = calc_stats(</span>
<span class="c1">#         kill_data.loc[</span>
<span class="c1">#             (kill_data[&quot;attackerTeam&quot;] != kill_data[&quot;victimTeam&quot;])</span>
<span class="c1">#             &amp; (kill_data[&quot;isFirstKill&quot;] == True)</span>
<span class="c1">#         ],</span>
<span class="c1">#         kill_filters,</span>
<span class="c1">#         [stats[1]],</span>
<span class="c1">#         [stats[1]],</span>
<span class="c1">#         [[&quot;size&quot;]],</span>
<span class="c1">#         [stats[4], &quot;FD&quot;],</span>
<span class="c1">#     )</span>
<span class="c1">#     headshots = calc_stats(</span>
<span class="c1">#         kill_data.loc[</span>
<span class="c1">#             (kill_data[&quot;attackerTeam&quot;] != kill_data[&quot;victimTeam&quot;])</span>
<span class="c1">#             &amp; (kill_data[&quot;isHeadshot&quot;] == True)</span>
<span class="c1">#         ],</span>
<span class="c1">#         kill_filters,</span>
<span class="c1">#         [stats[0]],</span>
<span class="c1">#         [stats[0]],</span>
<span class="c1">#         [[&quot;size&quot;]],</span>
<span class="c1">#         [stats[4], &quot;HS&quot;],</span>
<span class="c1">#     )</span>
<span class="c1">#     headshot_pct = calc_stats(</span>
<span class="c1">#         kill_data.loc[kill_data[&quot;attackerTeam&quot;] != kill_data[&quot;victimTeam&quot;]],</span>
<span class="c1">#         kill_filters,</span>
<span class="c1">#         [stats[0]],</span>
<span class="c1">#         [&quot;isHeadshot&quot;],</span>
<span class="c1">#         [[&quot;mean&quot;]],</span>
<span class="c1">#         [stats[4], &quot;HS%&quot;],</span>
<span class="c1">#     )</span>
<span class="c1">#     if not team:</span>
<span class="c1">#         acc_stats = accuracy(</span>
<span class="c1">#             damage_data, weapon_fire_data, False, damage_filters, weapon_fire_filters</span>
<span class="c1">#         )</span>
<span class="c1">#     else:</span>
<span class="c1">#         acc_stats = accuracy(</span>
<span class="c1">#             damage_data, weapon_fire_data, True, damage_filters, weapon_fire_filters</span>
<span class="c1">#         )</span>
<span class="c1">#     kast_stats = kast(kill_data, &quot;KAST&quot;, kill_filters, death_filters)</span>
<span class="c1">#     kill_stats = kills.merge(deaths, how=&quot;outer&quot;)  # .fillna(0)</span>
<span class="c1">#     kill_stats = kill_stats.merge(assists, how=&quot;outer&quot;)  # .fillna(0)</span>
<span class="c1">#     kill_stats = kill_stats.merge(flash_assists, how=&quot;outer&quot;)  # .fillna(0)</span>
<span class="c1">#     kill_stats = kill_stats.merge(first_kills, how=&quot;outer&quot;)  # .fillna(0)</span>
<span class="c1">#     kill_stats = kill_stats.merge(first_deaths, how=&quot;outer&quot;)  # .fillna(0)</span>
<span class="c1">#     kill_stats = kill_stats.merge(headshots, how=&quot;outer&quot;)  # .fillna(0)</span>
<span class="c1">#     kill_stats = kill_stats.merge(headshot_pct, how=&quot;outer&quot;)  # .fillna(0)</span>
<span class="c1">#     kill_stats = kill_stats.merge(acc_stats, how=&quot;outer&quot;)  # .fillna(0)</span>
<span class="c1">#     if not team:</span>
<span class="c1">#         kill_stats = kill_stats.merge(kast_stats, how=&quot;outer&quot;)  # .fillna(0)</span>
<span class="c1">#     kill_stats[&quot;+/-&quot;] = kill_stats[&quot;K&quot;] - kill_stats[&quot;D&quot;]</span>
<span class="c1">#     kill_stats[&quot;KDR&quot;] = kill_stats[&quot;K&quot;] / kill_stats[&quot;D&quot;]</span>
<span class="c1">#     kill_stats[&quot;KPR&quot;] = kill_stats[&quot;K&quot;] / len(</span>
<span class="c1">#         calc_stats(round_data, round_filters, [], [], [], round_data.columns)</span>
<span class="c1">#     )</span>
<span class="c1">#     kill_stats[&quot;FK +/-&quot;] = kill_stats[&quot;FK&quot;] - kill_stats[&quot;FD&quot;]</span>
<span class="c1">#     int_stats = [&quot;K&quot;, &quot;D&quot;, &quot;A&quot;, &quot;FA&quot;, &quot;+/-&quot;, &quot;FK&quot;, &quot;FK +/-&quot;, &quot;HS&quot;, &quot;T&quot;]</span>
<span class="c1">#     if team:</span>
<span class="c1">#         int_stats = int_stats[0:-1]</span>
<span class="c1">#     kill_stats[int_stats] = kill_stats[int_stats].astype(int)</span>
<span class="c1">#     kill_stats[&quot;HS%&quot;] = kill_stats[&quot;HS%&quot;].astype(float)</span>
<span class="c1">#     order = [</span>
<span class="c1">#         stats[4],</span>
<span class="c1">#         &quot;K&quot;,</span>
<span class="c1">#         &quot;D&quot;,</span>
<span class="c1">#         &quot;A&quot;,</span>
<span class="c1">#         &quot;FA&quot;,</span>
<span class="c1">#         &quot;+/-&quot;,</span>
<span class="c1">#         &quot;FK&quot;,</span>
<span class="c1">#         &quot;FK +/-&quot;,</span>
<span class="c1">#         &quot;T&quot;,</span>
<span class="c1">#         &quot;HS&quot;,</span>
<span class="c1">#         &quot;HS%&quot;,</span>
<span class="c1">#         &quot;ACC%&quot;,</span>
<span class="c1">#         &quot;HS ACC%&quot;,</span>
<span class="c1">#         &quot;KDR&quot;,</span>
<span class="c1">#         &quot;KPR&quot;,</span>
<span class="c1">#         &quot;KAST%&quot;,</span>
<span class="c1">#     ]</span>
<span class="c1">#     if team:</span>
<span class="c1">#         order = order[0:8] + order[9:-1]</span>
<span class="c1">#     kill_stats = kill_stats[order]</span>
<span class="c1">#     kill_stats.sort_values(by=&quot;K&quot;, ascending=False, inplace=True)</span>
<span class="c1">#     kill_stats.reset_index(drop=True, inplace=True)</span>
<span class="c1">#     return kill_stats</span>


<span class="c1"># def adr(</span>
<span class="c1">#     damage_data: pd.DataFrame,</span>
<span class="c1">#     round_data: pd.DataFrame,</span>
<span class="c1">#     team: bool = False,</span>
<span class="c1">#     damage_filters: Dict[str, Union[List[bool], List[str]]] = {},</span>
<span class="c1">#     round_filters: Dict[str, Union[List[bool], List[str]]] = {},</span>
<span class="c1"># ) -&gt; pd.DataFrame:</span>
<span class="c1">#     &quot;&quot;&quot;Returns a dataframe with ADR statistics.</span>

<span class="c1">#     Args:</span>
<span class="c1">#         damage_data: A dataframe with damage data.</span>
<span class="c1">#         round_data: A dataframe with round data.</span>
<span class="c1">#         team: A boolean specifying whether to calculate statistics for each team</span>
<span class="c1">#             or for each player. The default is to calculate statistics for</span>
<span class="c1">#             each player.</span>
<span class="c1">#         damage_filters: A dictionary where the keys are the columns of the</span>
<span class="c1">#             dataframe represented by damage_data to filter the damage data by</span>
<span class="c1">#             and the values are lists that contain the column filters.</span>
<span class="c1">#         round_filters: A dictionary where the keys are the columns of the</span>
<span class="c1">#             dataframe represented by round_data to filter the round data by and</span>
<span class="c1">#             the values are lists that contain the column filters.</span>

<span class="c1">#     Returns:</span>
<span class="c1">#         A dataframe with the average damage per round (ADR).</span>
<span class="c1">#     &quot;&quot;&quot;</span>
<span class="c1">#     stats = [&quot;attackerName&quot;, &quot;Player&quot;]</span>
<span class="c1">#     if team:</span>
<span class="c1">#         stats = [&quot;attackerTeam&quot;, &quot;Team&quot;]</span>
<span class="c1">#     adr = calc_stats(</span>
<span class="c1">#         damage_data.loc[damage_data[&quot;attackerTeam&quot;] != damage_data[&quot;victimTeam&quot;]],</span>
<span class="c1">#         damage_filters,</span>
<span class="c1">#         [stats[0]],</span>
<span class="c1">#         [&quot;hpDamageTaken&quot;, &quot;hpDamage&quot;],</span>
<span class="c1">#         [[&quot;sum&quot;], [&quot;sum&quot;]],</span>
<span class="c1">#         [stats[1], &quot;Norm ADR&quot;, &quot;Raw ADR&quot;],</span>
<span class="c1">#     )</span>
<span class="c1">#     adr[&quot;Norm ADR&quot;] = adr[&quot;Norm ADR&quot;] / len(</span>
<span class="c1">#         calc_stats(round_data, round_filters, [], [], [], round_data.columns)</span>
<span class="c1">#     )</span>
<span class="c1">#     adr[&quot;Raw ADR&quot;] = adr[&quot;Raw ADR&quot;] / len(</span>
<span class="c1">#         calc_stats(round_data, round_filters, [], [], [], round_data.columns)</span>
<span class="c1">#     )</span>
<span class="c1">#     adr.sort_values(by=&quot;Norm ADR&quot;, ascending=False, inplace=True)</span>
<span class="c1">#     adr.reset_index(drop=True, inplace=True)</span>
<span class="c1">#     return adr</span>


<span class="c1"># def rating(</span>
<span class="c1">#     damage_data: pd.DataFrame,</span>
<span class="c1">#     kill_data: pd.DataFrame,</span>
<span class="c1">#     round_data: pd.DataFrame,</span>
<span class="c1">#     damage_filters: Dict[str, Union[List[bool], List[str]]] = {},</span>
<span class="c1">#     death_filters: Dict[str, Union[List[bool], List[str]]] = {},</span>
<span class="c1">#     kill_filters: Dict[str, Union[List[bool], List[str]]] = {},</span>
<span class="c1">#     round_filters: Dict[str, Union[List[bool], List[str]]] = {},</span>
<span class="c1"># ) -&gt; pd.DataFrame:</span>
<span class="c1">#     &quot;&quot;&quot;Returns a dataframe with an HLTV-esque rating, found by doing:</span>

<span class="c1">#     Rating = 0.0073*KAST + 0.3591*KPR + -0.5329*DPR + 0.2372*Impact + 0.0032*ADR + 0.1587</span>
<span class="c1">#     where Impact = 2.13*KPR + 0.42*Assist per Round -0.41</span>

<span class="c1">#     Args:</span>
<span class="c1">#         damage_data: A dataframe with damage data.</span>
<span class="c1">#         kill_data: A dataframe with damage data.</span>
<span class="c1">#         round_data: A dataframe with round data.</span>
<span class="c1">#         damage_filters: A dictionary where the keys are the columns of the</span>
<span class="c1">#             dataframe represented by damage_data to filter the damage data by</span>
<span class="c1">#             and the values are lists that contain the column filters.</span>
<span class="c1">#         death_filters: A dictionary where the keys are the columns of the</span>
<span class="c1">#             dataframe represented by kill_data to filter the death data by and</span>
<span class="c1">#             the values are lists that contain the column filters.</span>
<span class="c1">#         kill_filters: A dictionary where the keys are the columns of the</span>
<span class="c1">#             dataframe represented by kill_data to filter the kill data by and</span>
<span class="c1">#             the values are lists that contain the column filters.</span>
<span class="c1">#         round_filters: A dictionary where the keys are the columns of the</span>
<span class="c1">#             dataframe represented by round_data to filter the round data by and</span>
<span class="c1">#             the values are lists that contain the column filters.</span>

<span class="c1">#     Returns:</span>
<span class="c1">#         A dataframe with the impact rating and rating 2.0</span>
<span class="c1">#     &quot;&quot;&quot;</span>
<span class="c1">#     kast_stats = kast(kill_data, &quot;KAST&quot;, kill_filters, death_filters)</span>
<span class="c1">#     kast_stats = kast_stats[[&quot;Player&quot;, &quot;KAST%&quot;]]</span>
<span class="c1">#     kast_stats.columns = [&quot;Player&quot;, &quot;KAST&quot;]</span>
<span class="c1">#     adr_stats = adr(damage_data, round_data, damage_filters, round_filters)</span>
<span class="c1">#     adr_stats = adr_stats[[&quot;Player&quot;, &quot;Norm ADR&quot;]]</span>
<span class="c1">#     adr_stats.columns = [&quot;Player&quot;, &quot;ADR&quot;]</span>
<span class="c1">#     stats = [&quot;attackerName&quot;, &quot;victimName&quot;, &quot;assisterName&quot;, &quot;flashThrowerName&quot;, &quot;Player&quot;]</span>
<span class="c1">#     kills = calc_stats(</span>
<span class="c1">#         kill_data.loc[kill_data[&quot;attackerTeam&quot;] != kill_data[&quot;victimTeam&quot;]],</span>
<span class="c1">#         kill_filters,</span>
<span class="c1">#         [stats[0]],</span>
<span class="c1">#         [stats[0]],</span>
<span class="c1">#         [[&quot;size&quot;]],</span>
<span class="c1">#         [stats[4], &quot;K&quot;],</span>
<span class="c1">#     )</span>
<span class="c1">#     deaths = calc_stats(</span>
<span class="c1">#         kill_data,</span>
<span class="c1">#         death_filters,</span>
<span class="c1">#         [stats[1]],</span>
<span class="c1">#         [stats[1]],</span>
<span class="c1">#         [[&quot;size&quot;]],</span>
<span class="c1">#         [stats[4], &quot;D&quot;],</span>
<span class="c1">#     )</span>
<span class="c1">#     assists = calc_stats(</span>
<span class="c1">#         kill_data.loc[kill_data[&quot;assisterTeam&quot;] != kill_data[&quot;victimTeam&quot;]],</span>
<span class="c1">#         kill_filters,</span>
<span class="c1">#         [stats[2]],</span>
<span class="c1">#         [stats[2]],</span>
<span class="c1">#         [[&quot;size&quot;]],</span>
<span class="c1">#         [stats[4], &quot;A&quot;],</span>
<span class="c1">#     )</span>
<span class="c1">#     kill_stats = kills.merge(deaths, how=&quot;outer&quot;)  # .fillna(0)</span>
<span class="c1">#     kill_stats = kill_stats.merge(assists, how=&quot;outer&quot;)  # .fillna(0)</span>
<span class="c1">#     kill_stats[&quot;KPR&quot;] = kill_stats[&quot;K&quot;] / len(</span>
<span class="c1">#         calc_stats(round_data, round_filters, [], [], [], round_data.columns)</span>
<span class="c1">#     )</span>
<span class="c1">#     kill_stats[&quot;DPR&quot;] = kill_stats[&quot;D&quot;] / len(</span>
<span class="c1">#         calc_stats(round_data, round_filters, [], [], [], round_data.columns)</span>
<span class="c1">#     )</span>
<span class="c1">#     kill_stats[&quot;APR&quot;] = kill_stats[&quot;A&quot;] / len(</span>
<span class="c1">#         calc_stats(round_data, round_filters, [], [], [], round_data.columns)</span>
<span class="c1">#     )</span>
<span class="c1">#     kill_stats = kill_stats[[&quot;Player&quot;, &quot;KPR&quot;, &quot;DPR&quot;, &quot;APR&quot;]]</span>
<span class="c1">#     kill_stats = kill_stats.merge(adr_stats, how=&quot;outer&quot;)  # .fillna(0)</span>
<span class="c1">#     kill_stats = kill_stats.merge(kast_stats, how=&quot;outer&quot;)  # .fillna(0)</span>
<span class="c1">#     kill_stats[&quot;Impact&quot;] = 2.13 * kill_stats[&quot;KPR&quot;] + 0.42 * kill_stats[&quot;APR&quot;] - 0.41</span>
<span class="c1">#     kill_stats[&quot;Rating&quot;] = (</span>
<span class="c1">#         0.73 * kill_stats[&quot;KAST&quot;]</span>
<span class="c1">#         + 0.3591 * kill_stats[&quot;KPR&quot;]</span>
<span class="c1">#         - 0.5329 * kill_stats[&quot;DPR&quot;]</span>
<span class="c1">#         + 0.2372 * kill_stats[&quot;Impact&quot;]</span>
<span class="c1">#         + 0.0032 * kill_stats[&quot;ADR&quot;]</span>
<span class="c1">#         + 0.1587</span>
<span class="c1">#     )</span>
<span class="c1">#     kill_stats = kill_stats[[&quot;Player&quot;, &quot;Impact&quot;, &quot;Rating&quot;]]</span>
<span class="c1">#     kill_stats.sort_values(by=&quot;Rating&quot;, ascending=False, inplace=True)</span>
<span class="c1">#     kill_stats.reset_index(drop=True, inplace=True)</span>
<span class="c1">#     return kill_stats</span>


<span class="c1"># def util_dmg(</span>
<span class="c1">#     damage_data: pd.DataFrame,</span>
<span class="c1">#     grenade_data: pd.DataFrame,</span>
<span class="c1">#     team: bool = False,</span>
<span class="c1">#     damage_filters: Dict[str, Union[List[bool], List[str]]] = {},</span>
<span class="c1">#     grenade_filters: Dict[str, Union[List[bool], List[str]]] = {},</span>
<span class="c1"># ) -&gt; pd.DataFrame:</span>
<span class="c1">#     &quot;&quot;&quot;Returns a dataframe with utility damage statistics.</span>

<span class="c1">#     Args:</span>
<span class="c1">#         damage_data: A dataframe with damage data.</span>
<span class="c1">#         grenade_data: A dataframe with grenade data.</span>
<span class="c1">#         team: A boolean specifying whether to calculate statistics for each team</span>
<span class="c1">#             or for each player. The default is to calculate statistics for</span>
<span class="c1">#             each player.</span>
<span class="c1">#         damage_filters: A dictionary where the keys are the columns of the</span>
<span class="c1">#             dataframe represented by damage_data to filter the damage data by</span>
<span class="c1">#             and the values are lists that contain the column filters.</span>
<span class="c1">#         grenade_filters: A dictionary where the keys are the columns of the</span>
<span class="c1">#             dataframe represented by grenade_data to filter the grenade data by</span>
<span class="c1">#             and the values are lists that contain the column filters.</span>

<span class="c1">#     Returns:</span>
<span class="c1">#         A dataframe with nades thrown, given utility damage (UD) per nade</span>
<span class="c1">#     &quot;&quot;&quot;</span>
<span class="c1">#     stats = [&quot;attackerName&quot;, &quot;throwerName&quot;, &quot;Player&quot;]</span>
<span class="c1">#     if team:</span>
<span class="c1">#         stats = [&quot;attackerTeam&quot;, &quot;throwerTeam&quot;, &quot;Team&quot;]</span>
<span class="c1">#     util_dmg = calc_stats(</span>
<span class="c1">#         damage_data.loc[</span>
<span class="c1">#             (damage_data[&quot;attackerTeam&quot;] != damage_data[&quot;victimTeam&quot;])</span>
<span class="c1">#             &amp; (</span>
<span class="c1">#                 damage_data[&quot;weapon&quot;].isin(</span>
<span class="c1">#                     [&quot;HE Grenade&quot;, &quot;Incendiary Grenade&quot;, &quot;Molotov&quot;]</span>
<span class="c1">#                 )</span>
<span class="c1">#             )</span>
<span class="c1">#         ],</span>
<span class="c1">#         damage_filters,</span>
<span class="c1">#         [stats[0]],</span>
<span class="c1">#         [&quot;hpDamageTaken&quot;, &quot;hpDamage&quot;],</span>
<span class="c1">#         [[&quot;sum&quot;], [&quot;sum&quot;]],</span>
<span class="c1">#         [stats[2], &quot;Given UD&quot;, &quot;UD&quot;],</span>
<span class="c1">#     )</span>
<span class="c1">#     nades_thrown = calc_stats(</span>
<span class="c1">#         grenade_data.loc[</span>
<span class="c1">#             grenade_data[&quot;grenadeType&quot;].isin(</span>
<span class="c1">#                 [&quot;HE Grenade&quot;, &quot;Incendiary Grenade&quot;, &quot;Molotov&quot;]</span>
<span class="c1">#             )</span>
<span class="c1">#         ],</span>
<span class="c1">#         grenade_filters,</span>
<span class="c1">#         [stats[1]],</span>
<span class="c1">#         [stats[1]],</span>
<span class="c1">#         [[&quot;size&quot;]],</span>
<span class="c1">#         [stats[2], &quot;Nades Thrown&quot;],</span>
<span class="c1">#     )</span>
<span class="c1">#     util_dmg_stats = util_dmg.merge(nades_thrown, how=&quot;outer&quot;)  # .fillna(0)</span>
<span class="c1">#     util_dmg_stats[&quot;Given UD Per Nade&quot;] = (</span>
<span class="c1">#         util_dmg_stats[&quot;Given UD&quot;] / util_dmg_stats[&quot;Nades Thrown&quot;]</span>
<span class="c1">#     )</span>
<span class="c1">#     util_dmg_stats[&quot;UD Per Nade&quot;] = (</span>
<span class="c1">#         util_dmg_stats[&quot;UD&quot;] / util_dmg_stats[&quot;Nades Thrown&quot;]</span>
<span class="c1">#     )</span>
<span class="c1">#     util_dmg_stats.sort_values(by=&quot;Given UD&quot;, ascending=False, inplace=True)</span>
<span class="c1">#     util_dmg_stats.reset_index(drop=True, inplace=True)</span>
<span class="c1">#     return util_dmg_stats</span>


<span class="c1"># def flash_stats(</span>
<span class="c1">#     flash_data: pd.DataFrame,</span>
<span class="c1">#     grenade_data: pd.DataFrame,</span>
<span class="c1">#     kill_data: pd.DataFrame,</span>
<span class="c1">#     team: bool = False,</span>
<span class="c1">#     flash_filters: Dict[str, Union[List[bool], List[str]]] = {},</span>
<span class="c1">#     grenade_filters: Dict[str, Union[List[bool], List[str]]] = {},</span>
<span class="c1">#     kill_filters: Dict[str, Union[List[bool], List[str]]] = {},</span>
<span class="c1"># ) -&gt; pd.DataFrame:</span>
<span class="c1">#     &quot;&quot;&quot;Returns a dataframe with flashbang statistics.</span>

<span class="c1">#     Args:</span>
<span class="c1">#         flash_data: A dataframe with flash data.</span>
<span class="c1">#         grenade_data: A dataframe with grenade data.</span>
<span class="c1">#         kill_data: A dataframe with kill data.</span>
<span class="c1">#         team: A boolean specifying whether to calculate statistics for each team</span>
<span class="c1">#             or for each player. The default is to calculate statistics for</span>
<span class="c1">#             each player.</span>
<span class="c1">#         flash_filters: A dictionary where the keys are the columns of the</span>
<span class="c1">#             dataframe represented by flash_data to filter the flash data by</span>
<span class="c1">#             and the values are lists that contain the column filters.</span>
<span class="c1">#         grenade_filters: A dictionary where the keys are the columns of the</span>
<span class="c1">#             dataframe represented by grenade_data to filter the grenade data by</span>
<span class="c1">#             and the values are lists that contain the column filters.</span>
<span class="c1">#         kill_filters: A dictionary where the keys are the columns of the</span>
<span class="c1">#             dataframe represented by kill_data to filter the kill data by and</span>
<span class="c1">#             the values are lists that contain the column filters.</span>

<span class="c1">#     Returns:</span>
<span class="c1">#         A dataframe with the effective flashes (EF), flash assists (FA), effective blind time (EBT), team flashes (TF), total flashes</span>
<span class="c1">#     &quot;&quot;&quot;</span>
<span class="c1">#     stats = [&quot;attackerName&quot;, &quot;flashThrowerName&quot;, &quot;throwerName&quot;, &quot;Player&quot;]</span>
<span class="c1">#     if team:</span>
<span class="c1">#         stats = [&quot;attackerTeam&quot;, &quot;flashThrowerTeam&quot;, &quot;throwerTeam&quot;, &quot;Team&quot;]</span>
<span class="c1">#     enemy_flashes = calc_stats(</span>
<span class="c1">#         flash_data.loc[flash_data[&quot;attackerTeam&quot;] != flash_data[&quot;playerTeam&quot;]],</span>
<span class="c1">#         flash_filters,</span>
<span class="c1">#         [stats[0]],</span>
<span class="c1">#         [stats[0]],</span>
<span class="c1">#         [[&quot;size&quot;]],</span>
<span class="c1">#         [stats[3], &quot;EF&quot;],</span>
<span class="c1">#     )</span>
<span class="c1">#     flash_assists = calc_stats(</span>
<span class="c1">#         kill_data.loc[kill_data[&quot;flashThrowerTeam&quot;] != kill_data[&quot;victimTeam&quot;]],</span>
<span class="c1">#         kill_filters,</span>
<span class="c1">#         [stats[1]],</span>
<span class="c1">#         [stats[1]],</span>
<span class="c1">#         [[&quot;size&quot;]],</span>
<span class="c1">#         [stats[3], &quot;FA&quot;],</span>
<span class="c1">#     )</span>
<span class="c1">#     blind_time = calc_stats(</span>
<span class="c1">#         flash_data.loc[flash_data[&quot;attackerTeam&quot;] != flash_data[&quot;playerTeam&quot;]],</span>
<span class="c1">#         flash_filters,</span>
<span class="c1">#         [stats[0]],</span>
<span class="c1">#         [&quot;flashDuration&quot;],</span>
<span class="c1">#         [[&quot;sum&quot;]],</span>
<span class="c1">#         [stats[3], &quot;EBT&quot;],</span>
<span class="c1">#     )</span>
<span class="c1">#     team_flashes = calc_stats(</span>
<span class="c1">#         flash_data.loc[flash_data[&quot;attackerTeam&quot;] == flash_data[&quot;playerTeam&quot;]],</span>
<span class="c1">#         flash_filters,</span>
<span class="c1">#         [stats[0]],</span>
<span class="c1">#         [stats[0]],</span>
<span class="c1">#         [[&quot;size&quot;]],</span>
<span class="c1">#         [stats[3], &quot;TF&quot;],</span>
<span class="c1">#     )</span>
<span class="c1">#     flashes_thrown = calc_stats(</span>
<span class="c1">#         grenade_data.loc[grenade_data[&quot;grenadeType&quot;] == &quot;Flashbang&quot;],</span>
<span class="c1">#         flash_filters,</span>
<span class="c1">#         [stats[2]],</span>
<span class="c1">#         [stats[2]],</span>
<span class="c1">#         [[&quot;size&quot;]],</span>
<span class="c1">#         [stats[3], &quot;Flashes Thrown&quot;],</span>
<span class="c1">#     )</span>
<span class="c1">#     flash_stats = enemy_flashes.merge(flash_assists, how=&quot;outer&quot;)  # .fillna(0)</span>
<span class="c1">#     flash_stats = flash_stats.merge(blind_time, how=&quot;outer&quot;)  # .fillna(0)</span>
<span class="c1">#     flash_stats = flash_stats.merge(team_flashes, how=&quot;outer&quot;)  # .fillna(0)</span>
<span class="c1">#     flash_stats = flash_stats.merge(flashes_thrown, how=&quot;outer&quot;)  # .fillna(0)</span>
<span class="c1">#     flash_stats[&quot;EF Per Throw&quot;] = flash_stats[&quot;EF&quot;] / flash_stats[&quot;Flashes Thrown&quot;]</span>
<span class="c1">#     flash_stats[&quot;EBT Per Enemy&quot;] = flash_stats[&quot;EBT&quot;] / flash_stats[&quot;EF&quot;]</span>
<span class="c1">#     flash_stats[&quot;FA&quot;] = flash_stats[&quot;FA&quot;].astype(int)</span>
<span class="c1">#     flash_stats.sort_values(by=&quot;EF&quot;, ascending=False, inplace=True)</span>
<span class="c1">#     flash_stats.reset_index(drop=True, inplace=True)</span>
<span class="c1">#     return flash_stats</span>


<span class="c1"># def bomb_stats(</span>
<span class="c1">#     bomb_data: pd.DataFrame,</span>
<span class="c1">#     bomb_filters: Dict[str, Union[List[bool], List[str]]] = {},</span>
<span class="c1"># ) -&gt; pd.DataFrame:</span>
<span class="c1">#     &quot;&quot;&quot;Returns a dataframe with bomb event statistics.</span>

<span class="c1">#     Args:</span>
<span class="c1">#         bomb_data: A dataframe with bomb event data.</span>
<span class="c1">#         bomb_filters: A dictionary where the keys are the columns of the</span>
<span class="c1">#             dataframe represented by bomb_data to filter the bomb data by and</span>
<span class="c1">#             the values are lists that contain the column filters.</span>

<span class="c1">#     Returns:</span>
<span class="c1">#         A dataframe with bomb plant summaries.</span>
<span class="c1">#     &quot;&quot;&quot;</span>
<span class="c1">#     team_one = bomb_data[&quot;playerTeam&quot;].unique()[0]</span>
<span class="c1">#     team_two = bomb_data[&quot;playerTeam&quot;].unique()[1]</span>
<span class="c1">#     team_one_plants = calc_stats(</span>
<span class="c1">#         bomb_data.loc[</span>
<span class="c1">#             (bomb_data[&quot;bombAction&quot;] == &quot;plant&quot;) &amp; (bomb_data[&quot;playerTeam&quot;] == team_one)</span>
<span class="c1">#         ],</span>
<span class="c1">#         bomb_filters,</span>
<span class="c1">#         [&quot;bombSite&quot;],</span>
<span class="c1">#         [&quot;bombSite&quot;],</span>
<span class="c1">#         [[&quot;size&quot;]],</span>
<span class="c1">#         [&quot;Bombsite&quot;, f&quot;{team_one} Plants&quot;],</span>
<span class="c1">#     )</span>
<span class="c1">#     team_two_plants = calc_stats(</span>
<span class="c1">#         bomb_data.loc[</span>
<span class="c1">#             (bomb_data[&quot;bombAction&quot;] == &quot;plant&quot;) &amp; (bomb_data[&quot;playerTeam&quot;] == team_two)</span>
<span class="c1">#         ],</span>
<span class="c1">#         bomb_filters,</span>
<span class="c1">#         [&quot;bombSite&quot;],</span>
<span class="c1">#         [&quot;bombSite&quot;],</span>
<span class="c1">#         [[&quot;size&quot;]],</span>
<span class="c1">#         [&quot;Bombsite&quot;, f&quot;{team_two} Plants&quot;],</span>
<span class="c1">#     )</span>
<span class="c1">#     team_one_defuses = calc_stats(</span>
<span class="c1">#         bomb_data.loc[</span>
<span class="c1">#             (bomb_data[&quot;bombAction&quot;] == &quot;defuse&quot;)</span>
<span class="c1">#             &amp; (bomb_data[&quot;playerTeam&quot;] == team_one)</span>
<span class="c1">#         ],</span>
<span class="c1">#         bomb_filters,</span>
<span class="c1">#         [&quot;bombSite&quot;],</span>
<span class="c1">#         [&quot;bombSite&quot;],</span>
<span class="c1">#         [[&quot;size&quot;]],</span>
<span class="c1">#         [&quot;Bombsite&quot;, f&quot;{team_one} Defuses&quot;],</span>
<span class="c1">#     )</span>
<span class="c1">#     team_two_defuses = calc_stats(</span>
<span class="c1">#         bomb_data.loc[</span>
<span class="c1">#             (bomb_data[&quot;bombAction&quot;] == &quot;defuse&quot;)</span>
<span class="c1">#             &amp; (bomb_data[&quot;playerTeam&quot;] == team_two)</span>
<span class="c1">#         ],</span>
<span class="c1">#         bomb_filters,</span>
<span class="c1">#         [&quot;bombSite&quot;],</span>
<span class="c1">#         [&quot;bombSite&quot;],</span>
<span class="c1">#         [[&quot;size&quot;]],</span>
<span class="c1">#         [&quot;Bombsite&quot;, f&quot;{team_two} Defuses&quot;],</span>
<span class="c1">#     )</span>
<span class="c1">#     bomb_stats = team_one_plants.merge(team_two_defuses, how=&quot;outer&quot;)  # .fillna(0)</span>
<span class="c1">#     bomb_stats[f&quot;{team_two} Defuse %&quot;] = (</span>
<span class="c1">#         bomb_stats[f&quot;{team_two} Defuses&quot;] / bomb_stats[f&quot;{team_one} Plants&quot;]</span>
<span class="c1">#     )</span>
<span class="c1">#     bomb_stats = bomb_stats.merge(team_two_plants, how=&quot;outer&quot;)  # .fillna(0)</span>
<span class="c1">#     bomb_stats = bomb_stats.merge(team_one_defuses, how=&quot;outer&quot;)  # .fillna(0)</span>
<span class="c1">#     bomb_stats[f&quot;{team_one} Defuse %&quot;] = (</span>
<span class="c1">#         bomb_stats[f&quot;{team_one} Defuses&quot;] / bomb_stats[f&quot;{team_two} Plants&quot;]</span>
<span class="c1">#     )</span>
<span class="c1">#     bomb_stats.loc[2] = [</span>
<span class="c1">#         &quot;A and B&quot;,</span>
<span class="c1">#         bomb_stats[f&quot;{team_one} Plants&quot;].sum(),</span>
<span class="c1">#         bomb_stats[f&quot;{team_two} Defuses&quot;].sum(),</span>
<span class="c1">#         (</span>
<span class="c1">#             bomb_stats[f&quot;{team_two} Defuses&quot;].sum()</span>
<span class="c1">#             / bomb_stats[f&quot;{team_one} Plants&quot;].sum()</span>
<span class="c1">#         ),</span>
<span class="c1">#         bomb_stats[f&quot;{team_two} Plants&quot;].sum(),</span>
<span class="c1">#         bomb_stats[f&quot;{team_one} Defuses&quot;].sum(),</span>
<span class="c1">#         (</span>
<span class="c1">#             bomb_stats[f&quot;{team_one} Defuses&quot;].sum()</span>
<span class="c1">#             / bomb_stats[f&quot;{team_two} Plants&quot;].sum()</span>
<span class="c1">#         ),</span>
<span class="c1">#     ]</span>
<span class="c1">#     bomb_stats  # .fillna(0, inplace=True)</span>
<span class="c1">#     bomb_stats.iloc[:, [1, 2, 4, 5]] = bomb_stats.iloc[:, [1, 2, 4, 5]].astype(int)</span>
<span class="c1">#     return bomb_stats</span>


<span class="c1"># def econ_stats(</span>
<span class="c1">#     round_data: pd.DataFrame,</span>
<span class="c1">#     round_filters: Dict[str, Union[List[bool], List[str]]] = {},</span>
<span class="c1"># ) -&gt; pd.DataFrame:</span>
<span class="c1">#     &quot;&quot;&quot;Returns a dataframe with economy statistics.</span>

<span class="c1">#     Args:</span>
<span class="c1">#         round_data: A dataframe with round data.</span>
<span class="c1">#         round_filters: A dictionary where the keys are the columns of the</span>
<span class="c1">#             dataframe represented by round_data to filter the round data by and</span>
<span class="c1">#             the values are lists that contain the column filters.</span>

<span class="c1">#     Returns:</span>
<span class="c1">#         A dataframe with round economy summaries.</span>
<span class="c1">#     &quot;&quot;&quot;</span>
<span class="c1">#     ct_stats = calc_stats(</span>
<span class="c1">#         round_data,</span>
<span class="c1">#         round_filters,</span>
<span class="c1">#         [&quot;ctTeam&quot;],</span>
<span class="c1">#         [&quot;ctStartEqVal&quot;, &quot;ctRoundStartMoney&quot;, &quot;ctSpend&quot;],</span>
<span class="c1">#         [[&quot;mean&quot;], [&quot;mean&quot;], [&quot;mean&quot;]],</span>
<span class="c1">#         [&quot;Side&quot;, &quot;Avg EQ Value&quot;, &quot;Avg Cash&quot;, &quot;Avg Spend&quot;],</span>
<span class="c1">#     )</span>
<span class="c1">#     ct_stats[&quot;Side&quot;] = ct_stats[&quot;Side&quot;] + &quot; CT&quot;</span>
<span class="c1">#     ct_buys = calc_stats(</span>
<span class="c1">#         round_data,</span>
<span class="c1">#         round_filters,</span>
<span class="c1">#         [&quot;ctTeam&quot;, &quot;ctBuyType&quot;],</span>
<span class="c1">#         [&quot;ctBuyType&quot;],</span>
<span class="c1">#         [[&quot;size&quot;]],</span>
<span class="c1">#         [&quot;Side&quot;, &quot;Buy Type&quot;, &quot;Counts&quot;],</span>
<span class="c1">#     )</span>
<span class="c1">#     ct_buys = ct_buys.pivot(index=&quot;Side&quot;, columns=&quot;Buy Type&quot;, values=&quot;Counts&quot;)</span>
<span class="c1">#     ct_buys.reset_index(inplace=True)</span>
<span class="c1">#     ct_buys.rename_axis(None, axis=1, inplace=True)</span>
<span class="c1">#     ct_buys[&quot;Side&quot;] = ct_buys[&quot;Side&quot;] + &quot; CT&quot;</span>
<span class="c1">#     t_stats = calc_stats(</span>
<span class="c1">#         round_data,</span>
<span class="c1">#         round_filters,</span>
<span class="c1">#         [&quot;tTeam&quot;],</span>
<span class="c1">#         [&quot;tStartEqVal&quot;, &quot;tRoundStartMoney&quot;, &quot;tSpend&quot;],</span>
<span class="c1">#         [[&quot;mean&quot;], [&quot;mean&quot;], [&quot;mean&quot;]],</span>
<span class="c1">#         [&quot;Side&quot;, &quot;Avg EQ Value&quot;, &quot;Avg Cash&quot;, &quot;Avg Spend&quot;],</span>
<span class="c1">#     )</span>
<span class="c1">#     t_stats[&quot;Side&quot;] = t_stats[&quot;Side&quot;] + &quot; T&quot;</span>
<span class="c1">#     t_buys = calc_stats(</span>
<span class="c1">#         round_data,</span>
<span class="c1">#         round_filters,</span>
<span class="c1">#         [&quot;tTeam&quot;, &quot;tBuyType&quot;],</span>
<span class="c1">#         [&quot;tBuyType&quot;],</span>
<span class="c1">#         [[&quot;size&quot;]],</span>
<span class="c1">#         [&quot;Side&quot;, &quot;Buy Type&quot;, &quot;Counts&quot;],</span>
<span class="c1">#     )</span>
<span class="c1">#     t_buys = t_buys.pivot(index=&quot;Side&quot;, columns=&quot;Buy Type&quot;, values=&quot;Counts&quot;)</span>
<span class="c1">#     t_buys.reset_index(inplace=True)</span>
<span class="c1">#     t_buys.rename_axis(None, axis=1, inplace=True)</span>
<span class="c1">#     t_buys[&quot;Side&quot;] = t_buys[&quot;Side&quot;] + &quot; T&quot;</span>
<span class="c1">#     econ_buys = ct_buys.append(t_buys)</span>
<span class="c1">#     econ_stats = ct_stats.append(t_stats)</span>
<span class="c1">#     econ_stats = econ_buys.merge(econ_stats, how=&quot;outer&quot;)</span>
<span class="c1">#     econ_stats  # .fillna(0, inplace=True)</span>
<span class="c1">#     econ_stats.iloc[:, 1:] = econ_stats.iloc[:, 1:].astype(int)</span>
<span class="c1">#     return econ_stats</span>


<span class="c1"># def weapon_type(weapon: str) -&gt; str:</span>
<span class="c1">#     &quot;&quot;&quot;Returns the weapon type of a weapon.</span>

<span class="c1">#     Args:</span>
<span class="c1">#         weapon: Weapon name</span>

<span class="c1">#     Returns:</span>
<span class="c1">#         A string for the weapon type (Knife, Pistol, Shotgun, SMG, Assault Rifle, Machine Gun, Sniper Rifle, Utility)</span>
<span class="c1">#     &quot;&quot;&quot;</span>
<span class="c1">#     if weapon in [&quot;Knife&quot;]:</span>
<span class="c1">#         return &quot;Melee Kills&quot;</span>
<span class="c1">#     elif weapon in [</span>
<span class="c1">#         &quot;CZ-75 Auto&quot;,</span>
<span class="c1">#         &quot;Desert Eagle&quot;,</span>
<span class="c1">#         &quot;Dual Berettas&quot;,</span>
<span class="c1">#         &quot;Five-SeveN&quot;,</span>
<span class="c1">#         &quot;Glock-18&quot;,</span>
<span class="c1">#         &quot;P2000&quot;,</span>
<span class="c1">#         &quot;P250&quot;,</span>
<span class="c1">#         &quot;R8 Revolver&quot;,</span>
<span class="c1">#         &quot;Tec-9&quot;,</span>
<span class="c1">#         &quot;USP-S&quot;,</span>
<span class="c1">#     ]:</span>
<span class="c1">#         return &quot;Pistol Kills&quot;</span>
<span class="c1">#     elif weapon in [&quot;MAG-7&quot;, &quot;Nova&quot;, &quot;Sawed-Off&quot;, &quot;XM1014&quot;]:</span>
<span class="c1">#         return &quot;Shotgun Kills&quot;</span>
<span class="c1">#     elif weapon in [&quot;MAC-10&quot;, &quot;MP5-SD&quot;, &quot;MP7&quot;, &quot;MP9&quot;, &quot;P90&quot;, &quot;PP-Bizon&quot;, &quot;UMP-45&quot;]:</span>
<span class="c1">#         return &quot;SMG Kills&quot;</span>
<span class="c1">#     elif weapon in [&quot;AK-47&quot;, &quot;AUG&quot;, &quot;FAMAS&quot;, &quot;Galil AR&quot;, &quot;M4A1-S&quot;, &quot;M4A4&quot;, &quot;SG 553&quot;]:</span>
<span class="c1">#         return &quot;Assault Rifle Kills&quot;</span>
<span class="c1">#     elif weapon in [&quot;M249&quot;, &quot;Negev&quot;]:</span>
<span class="c1">#         return &quot;Machine Gun Kills&quot;</span>
<span class="c1">#     elif weapon in [&quot;AWP&quot;, &quot;G3SG1&quot;, &quot;SCAR-20&quot;, &quot;SSG 08&quot;]:</span>
<span class="c1">#         return &quot;Sniper Rifle Kills&quot;</span>
<span class="c1">#     else:</span>
<span class="c1">#         return &quot;Utility Kills&quot;</span>


<span class="c1"># def kill_breakdown(</span>
<span class="c1">#     kill_data: pd.DataFrame,</span>
<span class="c1">#     team: bool = False,</span>
<span class="c1">#     kill_filters: Dict[str, Union[List[bool], List[str]]] = {},</span>
<span class="c1"># ) -&gt; pd.DataFrame:</span>
<span class="c1">#     &quot;&quot;&quot;Returns a dataframe with kills broken down by weapon type.</span>

<span class="c1">#     Args:</span>
<span class="c1">#         kill_data: A dataframe with kill data.</span>
<span class="c1">#         team: A boolean specifying whether to calculate statistics for each team</span>
<span class="c1">#             or for each player. The default is to calculate statistics for</span>
<span class="c1">#             each player.</span>
<span class="c1">#         kill_filters: A dictionary where the keys are the columns of the</span>
<span class="c1">#             dataframe represented by kill_data to filter the kill data by and</span>
<span class="c1">#             the values are lists that contain the column filters.</span>

<span class="c1">#     Returns:</span>
<span class="c1">#         A dataframe with kill type statistics.</span>
<span class="c1">#     &quot;&quot;&quot;</span>
<span class="c1">#     stats = [&quot;attackerName&quot;, &quot;Player&quot;]</span>
<span class="c1">#     if team:</span>
<span class="c1">#         stats = [&quot;attackerTeam&quot;, &quot;Team&quot;]</span>
<span class="c1">#     kill_breakdown = kill_data.loc[</span>
<span class="c1">#         kill_data[&quot;attackerTeam&quot;] != kill_data[&quot;victimTeam&quot;]</span>
<span class="c1">#     ].copy()</span>
<span class="c1">#     kill_breakdown[&quot;Kills Type&quot;] = kill_breakdown.apply(</span>
<span class="c1">#         lambda row: weapon_type(row[&quot;weapon&quot;]), axis=1</span>
<span class="c1">#     )</span>
<span class="c1">#     kill_breakdown = calc_stats(</span>
<span class="c1">#         kill_breakdown,</span>
<span class="c1">#         kill_filters,</span>
<span class="c1">#         [stats[0], &quot;Kills Type&quot;],</span>
<span class="c1">#         [stats[0]],</span>
<span class="c1">#         [[&quot;size&quot;]],</span>
<span class="c1">#         [stats[1], &quot;Kills Type&quot;, &quot;Kills&quot;],</span>
<span class="c1">#     )</span>
<span class="c1">#     kill_breakdown = kill_breakdown.pivot(</span>
<span class="c1">#         index=stats[1], columns=&quot;Kills Type&quot;, values=&quot;Kills&quot;</span>
<span class="c1">#     )</span>
<span class="c1">#     for col in [</span>
<span class="c1">#         &quot;Melee Kills&quot;,</span>
<span class="c1">#         &quot;Pistol Kills&quot;,</span>
<span class="c1">#         &quot;Shotgun Kills&quot;,</span>
<span class="c1">#         &quot;SMG Kills&quot;,</span>
<span class="c1">#         &quot;Assault Rifle Kills&quot;,</span>
<span class="c1">#         &quot;Machine Gun Kills&quot;,</span>
<span class="c1">#         &quot;Sniper Rifle Kills&quot;,</span>
<span class="c1">#         &quot;Utility Kills&quot;,</span>
<span class="c1">#     ]:</span>
<span class="c1">#         if not col in kill_breakdown.columns:</span>
<span class="c1">#             kill_breakdown.insert(0, col, 0)</span>
<span class="c1">#         kill_breakdown[col]  # .fillna(0, inplace=True)</span>
<span class="c1">#         kill_breakdown[col] = kill_breakdown[col].astype(int)</span>
<span class="c1">#     kill_breakdown[&quot;Total Kills&quot;] = kill_breakdown.iloc[0:].sum(axis=1)</span>
<span class="c1">#     kill_breakdown.reset_index(inplace=True)</span>
<span class="c1">#     kill_breakdown.rename_axis(None, axis=1, inplace=True)</span>
<span class="c1">#     kill_breakdown = kill_breakdown[</span>
<span class="c1">#         [</span>
<span class="c1">#             stats[1],</span>
<span class="c1">#             &quot;Melee Kills&quot;,</span>
<span class="c1">#             &quot;Pistol Kills&quot;,</span>
<span class="c1">#             &quot;Shotgun Kills&quot;,</span>
<span class="c1">#             &quot;SMG Kills&quot;,</span>
<span class="c1">#             &quot;Assault Rifle Kills&quot;,</span>
<span class="c1">#             &quot;Machine Gun Kills&quot;,</span>
<span class="c1">#             &quot;Sniper Rifle Kills&quot;,</span>
<span class="c1">#             &quot;Utility Kills&quot;,</span>
<span class="c1">#             &quot;Total Kills&quot;,</span>
<span class="c1">#         ]</span>
<span class="c1">#     ]</span>
<span class="c1">#     kill_breakdown.sort_values(by=&quot;Total Kills&quot;, ascending=False, inplace=True)</span>
<span class="c1">#     kill_breakdown.reset_index(drop=True, inplace=True)</span>
<span class="c1">#     return kill_breakdown</span>


<span class="c1"># def util_dmg_breakdown(</span>
<span class="c1">#     damage_data: pd.DataFrame,</span>
<span class="c1">#     grenade_data: pd.DataFrame,</span>
<span class="c1">#     team: bool = False,</span>
<span class="c1">#     damage_filters: Dict[str, Union[List[bool], List[str]]] = {},</span>
<span class="c1">#     grenade_filters: Dict[str, Union[List[bool], List[str]]] = {},</span>
<span class="c1"># ) -&gt; pd.DataFrame:</span>
<span class="c1">#     &quot;&quot;&quot;Returns a dataframe with utility damage statistics broken down by grenade type.</span>

<span class="c1">#     Args:</span>
<span class="c1">#         damage_data: A dataframe with damage data.</span>
<span class="c1">#         grenade_data: A dataframe with grenade data.</span>
<span class="c1">#         team: A boolean specifying whether to calculate statistics for each team</span>
<span class="c1">#             or for each player. The default is to calculate statistics for</span>
<span class="c1">#             each player.</span>
<span class="c1">#         damage_filters: A dictionary where the keys are the columns of the</span>
<span class="c1">#             dataframe represented by damage_data to filter the damage data by</span>
<span class="c1">#             and the values are lists that contain the column filters.</span>
<span class="c1">#         grenade_filters: A dictionary where the keys are the columns of the</span>
<span class="c1">#             dataframe represented by grenade_data to filter the grenade data by</span>
<span class="c1">#             and the values are lists that contain the column filters.</span>

<span class="c1">#     Returns:</span>
<span class="c1">#         A dataframe with utility damage summary.</span>
<span class="c1">#     &quot;&quot;&quot;</span>
<span class="c1">#     stats = [&quot;attackerName&quot;, &quot;throwerName&quot;, &quot;Player&quot;]</span>
<span class="c1">#     if team:</span>
<span class="c1">#         stats = [&quot;attackerTeam&quot;, &quot;throwerTeam&quot;, &quot;Team&quot;]</span>
<span class="c1">#     util_dmg = calc_stats(</span>
<span class="c1">#         damage_data.loc[</span>
<span class="c1">#             (damage_data[&quot;attackerTeam&quot;] != damage_data[&quot;victimTeam&quot;])</span>
<span class="c1">#             &amp; (</span>
<span class="c1">#                 damage_data[&quot;weapon&quot;].isin(</span>
<span class="c1">#                     [&quot;HE Grenade&quot;, &quot;Incendiary Grenade&quot;, &quot;Molotov&quot;]</span>
<span class="c1">#                 )</span>
<span class="c1">#             )</span>
<span class="c1">#         ],</span>
<span class="c1">#         damage_filters,</span>
<span class="c1">#         [stats[0], &quot;weapon&quot;],</span>
<span class="c1">#         [&quot;hpDamageTaken&quot;, &quot;hpDamage&quot;],</span>
<span class="c1">#         [[&quot;sum&quot;], [&quot;sum&quot;]],</span>
<span class="c1">#         [stats[2], &quot;Nade Type&quot;, &quot;Given UD&quot;, &quot;UD&quot;],</span>
<span class="c1">#     )</span>
<span class="c1">#     nades_thrown = calc_stats(</span>
<span class="c1">#         grenade_data.loc[</span>
<span class="c1">#             grenade_data[&quot;grenadeType&quot;].isin(</span>
<span class="c1">#                 [&quot;HE Grenade&quot;, &quot;Incendiary Grenade&quot;, &quot;Molotov&quot;]</span>
<span class="c1">#             )</span>
<span class="c1">#         ],</span>
<span class="c1">#         grenade_filters,</span>
<span class="c1">#         [stats[1], &quot;grenadeType&quot;],</span>
<span class="c1">#         [stats[1]],</span>
<span class="c1">#         [[&quot;size&quot;]],</span>
<span class="c1">#         [stats[2], &quot;Nade Type&quot;, &quot;Nades Thrown&quot;],</span>
<span class="c1">#     )</span>
<span class="c1">#     util_dmg_breakdown = util_dmg.merge(</span>
<span class="c1">#         nades_thrown, how=&quot;outer&quot;, on=[stats[2], &quot;Nade Type&quot;]</span>
<span class="c1">#     )  # .fillna(0)</span>
<span class="c1">#     util_dmg_breakdown[&quot;Given UD Per Nade&quot;] = (</span>
<span class="c1">#         util_dmg_breakdown[&quot;Given UD&quot;] / util_dmg_breakdown[&quot;Nades Thrown&quot;]</span>
<span class="c1">#     )</span>
<span class="c1">#     util_dmg_breakdown[&quot;UD Per Nade&quot;] = (</span>
<span class="c1">#         util_dmg_breakdown[&quot;UD&quot;] / util_dmg_breakdown[&quot;Nades Thrown&quot;]</span>
<span class="c1">#     )</span>
<span class="c1">#     util_dmg_breakdown.sort_values(</span>
<span class="c1">#         by=[stats[2], &quot;Given UD&quot;], ascending=[True, False], inplace=True</span>
<span class="c1">#     )</span>
<span class="c1">#     util_dmg_breakdown.reset_index(drop=True, inplace=True)</span>
<span class="c1">#     return util_dmg_breakdown</span>


<span class="c1"># def win_breakdown(</span>
<span class="c1">#     round_data: pd.DataFrame,</span>
<span class="c1">#     round_filters: Dict[str, Union[List[bool], List[str]]] = {},</span>
<span class="c1"># ) -&gt; pd.DataFrame:</span>
<span class="c1">#     &quot;&quot;&quot;Returns a dataframe with wins broken down by round end reason.</span>

<span class="c1">#     Args:</span>
<span class="c1">#         round_data: A dataframe with round data.</span>
<span class="c1">#         round_filters: A dictionary where the keys are the columns of the</span>
<span class="c1">#             dataframe represented by round_data to filter the round data by and</span>
<span class="c1">#             the values are lists that contain the column filters.</span>

<span class="c1">#     Returns:</span>
<span class="c1">#         A dataframe with round wins described by reason.</span>
<span class="c1">#     &quot;&quot;&quot;</span>
<span class="c1">#     round_data_copy = round_data.copy()</span>
<span class="c1">#     round_data_copy.replace(&quot;BombDefused&quot;, &quot;CT Bomb Defusal Wins&quot;, inplace=True)</span>
<span class="c1">#     round_data_copy.replace(&quot;CTWin&quot;, &quot;CT T Elim Wins&quot;, inplace=True)</span>
<span class="c1">#     round_data_copy.replace(&quot;TargetBombed&quot;, &quot;T Bomb Detonation Wins&quot;, inplace=True)</span>
<span class="c1">#     round_data_copy.replace(&quot;TargetSaved&quot;, &quot;CT Time Expired Wins&quot;, inplace=True)</span>
<span class="c1">#     round_data_copy.replace(&quot;TerroristsWin&quot;, &quot;T CT Elim Wins&quot;, inplace=True)</span>
<span class="c1">#     win_breakdown = calc_stats(</span>
<span class="c1">#         round_data_copy,</span>
<span class="c1">#         round_filters,</span>
<span class="c1">#         [&quot;winningTeam&quot;, &quot;roundEndReason&quot;],</span>
<span class="c1">#         [&quot;roundEndReason&quot;],</span>
<span class="c1">#         [[&quot;size&quot;]],</span>
<span class="c1">#         [&quot;Team&quot;, &quot;RoundEndReason&quot;, &quot;Count&quot;],</span>
<span class="c1">#     )</span>
<span class="c1">#     win_breakdown = win_breakdown.pivot(</span>
<span class="c1">#         index=&quot;Team&quot;, columns=&quot;RoundEndReason&quot;, values=&quot;Count&quot;</span>
<span class="c1">#     )  # .fillna(0)</span>
<span class="c1">#     win_breakdown.reset_index(inplace=True)</span>
<span class="c1">#     win_breakdown.rename_axis(None, axis=1, inplace=True)</span>
<span class="c1">#     win_breakdown[&quot;Total CT Wins&quot;] = win_breakdown.iloc[0:][</span>
<span class="c1">#         list(</span>
<span class="c1">#             set.intersection(</span>
<span class="c1">#                 set(win_breakdown.columns),</span>
<span class="c1">#                 set([&quot;CT Bomb Defusal Wins&quot;, &quot;CT T Elim Wins&quot;, &quot;CT Time Expired Wins&quot;]),</span>
<span class="c1">#             )</span>
<span class="c1">#         )</span>
<span class="c1">#     ].sum(axis=1)</span>
<span class="c1">#     win_breakdown[&quot;Total T Wins&quot;] = win_breakdown.iloc[0:][</span>
<span class="c1">#         list(</span>
<span class="c1">#             set.intersection(</span>
<span class="c1">#                 set(win_breakdown.columns),</span>
<span class="c1">#                 set([&quot;T Bomb Detonation Wins&quot;, &quot;T CT Elim Wins&quot;]),</span>
<span class="c1">#             )</span>
<span class="c1">#         )</span>
<span class="c1">#     ].sum(axis=1)</span>
<span class="c1">#     win_breakdown[&quot;Total Wins&quot;] = win_breakdown.iloc[0:, 0:-2].sum(axis=1)</span>
<span class="c1">#     win_breakdown.iloc[:, 1:] = win_breakdown.iloc[:, 1:].astype(int)</span>
<span class="c1">#     return win_breakdown</span>


<span class="c1"># def player_box_score(</span>
<span class="c1">#     damage_data: pd.DataFrame,</span>
<span class="c1">#     flash_data: pd.DataFrame,</span>
<span class="c1">#     grenade_data: pd.DataFrame,</span>
<span class="c1">#     kill_data: pd.DataFrame,</span>
<span class="c1">#     round_data: pd.DataFrame,</span>
<span class="c1">#     weapon_fire_data: pd.DataFrame,</span>
<span class="c1">#     damage_filters: Dict[str, Union[List[bool], List[str]]] = {},</span>
<span class="c1">#     flash_filters: Dict[str, Union[List[bool], List[str]]] = {},</span>
<span class="c1">#     grenade_filters: Dict[str, Union[List[bool], List[str]]] = {},</span>
<span class="c1">#     kill_filters: Dict[str, Union[List[bool], List[str]]] = {},</span>
<span class="c1">#     death_filters: Dict[str, Union[List[bool], List[str]]] = {},</span>
<span class="c1">#     round_filters: Dict[str, Union[List[bool], List[str]]] = {},</span>
<span class="c1">#     weapon_fire_filters: Dict[str, Union[List[bool], List[str]]] = {},</span>
<span class="c1"># ) -&gt; pd.DataFrame:</span>
<span class="c1">#     &quot;&quot;&quot;Returns a player box score dataframe.</span>

<span class="c1">#     Args:</span>
<span class="c1">#        damage_data: A dataframe with damage data.</span>
<span class="c1">#        flash_data: A dataframe with flash data.</span>
<span class="c1">#        grenade_data: A dataframe with grenade data.</span>
<span class="c1">#        kill_data: A dataframe with kill data.</span>
<span class="c1">#        round_data: A dataframe with round data.</span>
<span class="c1">#        weapon_fire_data: A dataframe with weapon fire data.</span>
<span class="c1">#        damage_filters: A dictionary where the keys are the columns of the</span>
<span class="c1">#            dataframe represented by damage_data to filter the damage data by</span>
<span class="c1">#            and the values are lists that contain the column filters.</span>
<span class="c1">#        flash_filters: A dictionary where the keys are the columns of the</span>
<span class="c1">#            dataframe represented by flash_data to filter the flash data by</span>
<span class="c1">#            and the values are lists that contain the column filters.</span>
<span class="c1">#        grenade_filters: A dictionary where the keys are the columns of the</span>
<span class="c1">#            dataframe represented by grenade_data to filter the grenade data by</span>
<span class="c1">#            and the values are lists that contain the column filters.</span>
<span class="c1">#        kill_filters: A dictionary where the keys are the columns of the</span>
<span class="c1">#            dataframe represented by kill_data to filter the kill data by and</span>
<span class="c1">#            the values are lists that contain the column filters.</span>
<span class="c1">#        death_filters: A dictionary where the keys are the columns of the</span>
<span class="c1">#            dataframe represented by kill_data to filter the death data by and</span>
<span class="c1">#            the values are lists that contain the column filters.</span>
<span class="c1">#        round_filters: A dictionary where the keys are the columns of the</span>
<span class="c1">#            dataframe represented by round_data to filter the round data by and</span>
<span class="c1">#            the values are lists that contain the column filters.</span>
<span class="c1">#        weapon_fire_filters: A dictionary where the keys are the columns of the</span>
<span class="c1">#            dataframe to filter the weapon fire data by and the values are lists</span>
<span class="c1">#            that contain the column filters.</span>

<span class="c1">#     Returns:</span>
<span class="c1">#         A dataframe with player summaries.</span>
<span class="c1">#     &quot;&quot;&quot;</span>
<span class="c1">#     k_stats = kill_stats(</span>
<span class="c1">#         damage_data,</span>
<span class="c1">#         kill_data,</span>
<span class="c1">#         round_data,</span>
<span class="c1">#         weapon_fire_data,</span>
<span class="c1">#         damage_filters,</span>
<span class="c1">#         kill_filters,</span>
<span class="c1">#         death_filters,</span>
<span class="c1">#         round_filters,</span>
<span class="c1">#         weapon_fire_filters,</span>
<span class="c1">#     )</span>
<span class="c1">#     k_stats = k_stats[</span>
<span class="c1">#         [&quot;Player&quot;, &quot;K&quot;, &quot;D&quot;, &quot;A&quot;, &quot;FA&quot;, &quot;HS%&quot;, &quot;ACC%&quot;, &quot;HS ACC%&quot;, &quot;KDR&quot;, &quot;KAST%&quot;]</span>
<span class="c1">#     ]</span>
<span class="c1">#     adr_stats = adr(damage_data, round_data, damage_filters, round_filters)</span>
<span class="c1">#     adr_stats = adr_stats[[&quot;Player&quot;, &quot;Norm ADR&quot;]]</span>
<span class="c1">#     adr_stats.columns = [&quot;Player&quot;, &quot;ADR&quot;]</span>
<span class="c1">#     ud_stats = util_dmg(damage_data, grenade_data, damage_filters, grenade_filters)</span>
<span class="c1">#     ud_stats = ud_stats[[&quot;Player&quot;, &quot;UD&quot;, &quot;UD Per Nade&quot;]]</span>
<span class="c1">#     f_stats = flash_stats(</span>
<span class="c1">#         flash_data,</span>
<span class="c1">#         grenade_data,</span>
<span class="c1">#         kill_data,</span>
<span class="c1">#         flash_filters,</span>
<span class="c1">#         grenade_filters,</span>
<span class="c1">#         kill_filters,</span>
<span class="c1">#     )</span>
<span class="c1">#     f_stats = f_stats[[&quot;Player&quot;, &quot;EF&quot;, &quot;EF Per Throw&quot;]]</span>
<span class="c1">#     rating_stats = rating(</span>
<span class="c1">#         damage_data,</span>
<span class="c1">#         kill_data,</span>
<span class="c1">#         round_data,</span>
<span class="c1">#         damage_filters,</span>
<span class="c1">#         death_filters,</span>
<span class="c1">#         kill_filters,</span>
<span class="c1">#         round_filters,</span>
<span class="c1">#     )</span>
<span class="c1">#     box_score = k_stats.merge(adr_stats, how=&quot;outer&quot;)  # .fillna(0)</span>
<span class="c1">#     box_score = box_score.merge(ud_stats, how=&quot;outer&quot;)  # .fillna(0)</span>
<span class="c1">#     box_score = box_score.merge(f_stats, how=&quot;outer&quot;)  # .fillna(0)</span>
<span class="c1">#     box_score = box_score.merge(rating_stats, how=&quot;outer&quot;)  # .fillna(0)</span>
<span class="c1">#     return box_score</span>


<span class="c1"># def team_box_score(</span>
<span class="c1">#     damage_data: pd.DataFrame,</span>
<span class="c1">#     flash_data: pd.DataFrame,</span>
<span class="c1">#     grenade_data: pd.DataFrame,</span>
<span class="c1">#     kill_data: pd.DataFrame,</span>
<span class="c1">#     round_data: pd.DataFrame,</span>
<span class="c1">#     weapon_fire_data: pd.DataFrame,</span>
<span class="c1">#     damage_filters: Dict[str, Union[List[bool], List[str]]] = {},</span>
<span class="c1">#     flash_filters: Dict[str, Union[List[bool], List[str]]] = {},</span>
<span class="c1">#     grenade_filters: Dict[str, Union[List[bool], List[str]]] = {},</span>
<span class="c1">#     kill_filters: Dict[str, Union[List[bool], List[str]]] = {},</span>
<span class="c1">#     death_filters: Dict[str, Union[List[bool], List[str]]] = {},</span>
<span class="c1">#     round_filters: Dict[str, Union[List[bool], List[str]]] = {},</span>
<span class="c1">#     weapon_fire_filters: Dict[str, Union[List[bool], List[str]]] = {},</span>
<span class="c1"># ) -&gt; pd.DataFrame:</span>
<span class="c1">#     &quot;&quot;&quot;Returns a team box score dataframe.</span>

<span class="c1">#     Args:</span>
<span class="c1">#        damage_data: A dataframe with damage data.</span>
<span class="c1">#        flash_data: A dataframe with flash data.</span>
<span class="c1">#        grenade_data: A dataframe with grenade data.</span>
<span class="c1">#        kill_data: A dataframe with kill data.</span>
<span class="c1">#        round_data: A dataframe with round data.</span>
<span class="c1">#        weapon_fire_data: A dataframe with weapon fire data.</span>
<span class="c1">#        damage_filters: A dictionary where the keys are the columns of the</span>
<span class="c1">#            dataframe represented by damage_data to filter the damage data by</span>
<span class="c1">#            and the values are lists that contain the column filters.</span>
<span class="c1">#        flash_filters: A dictionary where the keys are the columns of the</span>
<span class="c1">#            dataframe represented by flash_data to filter the flash data by</span>
<span class="c1">#            and the values are lists that contain the column filters.</span>
<span class="c1">#        grenade_filters: A dictionary where the keys are the columns of the</span>
<span class="c1">#            dataframe represented by grenade_data to filter the grenade data by</span>
<span class="c1">#            and the values are lists that contain the column filters.</span>
<span class="c1">#        kill_filters: A dictionary where the keys are the columns of the</span>
<span class="c1">#            dataframe represented by kill_data to filter the kill data by and</span>
<span class="c1">#            the values are lists that contain the column filters.</span>
<span class="c1">#        death_filters: A dictionary where the keys are the columns of the</span>
<span class="c1">#            dataframe represented by kill_data to filter the death data by and</span>
<span class="c1">#            the values are lists that contain the column filters.</span>
<span class="c1">#        round_filters: A dictionary where the keys are the columns of the</span>
<span class="c1">#            dataframe represented by round_data to filter the round data by and</span>
<span class="c1">#            the values are lists that contain the column filters.</span>
<span class="c1">#        weapon_fire_filters: A dictionary where the keys are the columns of the</span>
<span class="c1">#            dataframe to filter the weapon fire data by and the values are lists</span>
<span class="c1">#            that contain the column filters.</span>

<span class="c1">#     Returns:</span>
<span class="c1">#         A dataframe with team summaries.</span>
<span class="c1">#     &quot;&quot;&quot;</span>
<span class="c1">#     k_stats = kill_stats(</span>
<span class="c1">#         damage_data,</span>
<span class="c1">#         kill_data,</span>
<span class="c1">#         round_data,</span>
<span class="c1">#         weapon_fire_data,</span>
<span class="c1">#         True,</span>
<span class="c1">#         damage_filters,</span>
<span class="c1">#         kill_filters,</span>
<span class="c1">#         death_filters,</span>
<span class="c1">#         round_filters,</span>
<span class="c1">#         weapon_fire_filters,</span>
<span class="c1">#     )</span>
<span class="c1">#     acc_stats = accuracy(</span>
<span class="c1">#         damage_data, weapon_fire_data, True, damage_filters, weapon_fire_filters</span>
<span class="c1">#     )</span>
<span class="c1">#     adr_stats = adr(damage_data, round_data, True, damage_filters, round_filters)</span>
<span class="c1">#     ud_stats = util_dmg(</span>
<span class="c1">#         damage_data, grenade_data, True, damage_filters, grenade_filters</span>
<span class="c1">#     )</span>
<span class="c1">#     f_stats = flash_stats(</span>
<span class="c1">#         flash_data,</span>
<span class="c1">#         grenade_data,</span>
<span class="c1">#         kill_data,</span>
<span class="c1">#         True,</span>
<span class="c1">#         flash_filters,</span>
<span class="c1">#         grenade_filters,</span>
<span class="c1">#         kill_filters,</span>
<span class="c1">#     )</span>
<span class="c1">#     e_stats = econ_stats(round_data, round_filters)</span>
<span class="c1">#     for index in e_stats.index:</span>
<span class="c1">#         e_stats.iloc[index, 0] = e_stats[&quot;Side&quot;].str.rsplit(n=1)[index][0]</span>
<span class="c1">#         rounds = e_stats.iloc[index, 1:-4].sum()</span>
<span class="c1">#         e_stats.iloc[index, -3:] = e_stats.iloc[index, -3:] * rounds</span>
<span class="c1">#     e_stats = e_stats.groupby([&quot;Side&quot;]).sum()</span>
<span class="c1">#     e_stats.reset_index(inplace=True)</span>
<span class="c1">#     e_stats.iloc[:, -3:] = (</span>
<span class="c1">#         e_stats.iloc[:, -3:] / len(filter_df(round_data, round_filters))</span>
<span class="c1">#     ).astype(int)</span>
<span class="c1">#     e_stats.rename(columns={&quot;Side&quot;: &quot;Team&quot;}, inplace=True)</span>
<span class="c1">#     box_score = k_stats.merge(acc_stats, how=&quot;outer&quot;)</span>
<span class="c1">#     box_score = box_score.merge(adr_stats, how=&quot;outer&quot;)</span>
<span class="c1">#     box_score = box_score.merge(ud_stats, how=&quot;outer&quot;)</span>
<span class="c1">#     box_score = box_score.merge(f_stats, how=&quot;outer&quot;)</span>
<span class="c1">#     box_score = box_score.merge(e_stats, how=&quot;outer&quot;)</span>
<span class="c1">#     box_score = box_score.merge(</span>
<span class="c1">#         win_breakdown(round_data, round_filters), how=&quot;outer&quot;</span>
<span class="c1">#     )  # .fillna(0)</span>
<span class="c1">#     box_score.rename(</span>
<span class="c1">#         columns={</span>
<span class="c1">#             &quot;Norm ADR&quot;: &quot;ADR&quot;,</span>
<span class="c1">#             &quot;Total CT Wins&quot;: &quot;CT Wins&quot;,</span>
<span class="c1">#             &quot;Total T Wins&quot;: &quot;T Wins&quot;,</span>
<span class="c1">#             &quot;Total Wins&quot;: &quot;Score&quot;,</span>
<span class="c1">#         },</span>
<span class="c1">#         inplace=True,</span>
<span class="c1">#     )</span>
<span class="c1">#     score = box_score[&quot;Score&quot;]</span>
<span class="c1">#     ct_wins = box_score[&quot;CT Wins&quot;]</span>
<span class="c1">#     t_wins = box_score[&quot;T Wins&quot;]</span>
<span class="c1">#     box_score.drop([&quot;Score&quot;, &quot;CT Wins&quot;, &quot;T Wins&quot;], axis=1, inplace=True)</span>
<span class="c1">#     box_score.insert(1, &quot;Score&quot;, score)</span>
<span class="c1">#     box_score.insert(2, &quot;CT Wins&quot;, ct_wins)</span>
<span class="c1">#     box_score.insert(3, &quot;T Wins&quot;, t_wins)</span>
<span class="c1">#     box_score = box_score.transpose()</span>
<span class="c1">#     box_score.columns = box_score.iloc[0]</span>
<span class="c1">#     box_score.drop(&quot;Team&quot;, inplace=True)</span>
<span class="c1">#     box_score.rename_axis(None, axis=1, inplace=True)</span>
<span class="c1">#     box_score = box_score.loc[</span>
<span class="c1">#         [</span>
<span class="c1">#             &quot;Score&quot;,</span>
<span class="c1">#             &quot;CT Wins&quot;,</span>
<span class="c1">#             &quot;T Wins&quot;,</span>
<span class="c1">#             &quot;K&quot;,</span>
<span class="c1">#             &quot;D&quot;,</span>
<span class="c1">#             &quot;A&quot;,</span>
<span class="c1">#             &quot;FA&quot;,</span>
<span class="c1">#             &quot;+/-&quot;,</span>
<span class="c1">#             &quot;FK&quot;,</span>
<span class="c1">#             &quot;HS&quot;,</span>
<span class="c1">#             &quot;HS%&quot;,</span>
<span class="c1">#             &quot;Strafe%&quot;,</span>
<span class="c1">#             &quot;ACC%&quot;,</span>
<span class="c1">#             &quot;HS ACC%&quot;,</span>
<span class="c1">#             &quot;ADR&quot;,</span>
<span class="c1">#             &quot;UD&quot;,</span>
<span class="c1">#             &quot;Nades Thrown&quot;,</span>
<span class="c1">#             &quot;UD Per Nade&quot;,</span>
<span class="c1">#             &quot;EF&quot;,</span>
<span class="c1">#             &quot;Flashes Thrown&quot;,</span>
<span class="c1">#             &quot;EF Per Throw&quot;,</span>
<span class="c1">#             &quot;EBT Per Enemy&quot;,</span>
<span class="c1">#         ],</span>
<span class="c1">#         :,</span>
<span class="c1">#     ].append(box_score.iloc[31:, :])</span>
<span class="c1">#     return box_score</span>
</pre></div>

           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2022, Peter Xenopoulos.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>